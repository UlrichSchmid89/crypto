# https://pypi.python.org/pypi/mwviews
# https://github.com/Commonists/pageview-api
# https://wikimedia.org/api/rest_v1/#!/Pageviews_data/get_metrics_pageviews_per_article_project_access_agent_article_granularity_start_end
# actual (not legacy) https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/bitcoin/daily/2010071800/20181124

# https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/bitcoin/daily/2010071800/20181124
# https://wikitech.wikimedia.org/wiki/Analytics/Pageviews
# https://wikitech.wikimedia.org/wiki/Analytics/Systems/Dashiki
# https://github.com/abelsson/stats.grok.se/blob/master/backend/getstats.py
# https://dumps.wikimedia.org/other/pagecounts-raw/
# https://dumps.wikimedia.org/other/pagecounts-ez/

import gzip
import os
# from tkinter import Tk
import scipy
import datetime as dt
print('scipy: %s' % scipy.__version__)
import numpy as np
print('numpy: %s' % np.__version__)
import pandas as pd
import hashlib
print('pandas: %s' % pd.__version__)

print(os.getcwd())

def main():
    print("First Module's Name: {}".format(__name__))

    if os.name == 'posix':
        sl = '/'
    elif os.name == 'nt':
        sl = '\\'

    # All Files to be read in current cycle of scraping
    files = [
        'pagecounts-20101101-000000.gz',
        'pagecounts-20101101-010000.gz',
        'pagecounts-20101101-020000.gz',
        'pagecounts-20101101-030000.gz',
        'pagecounts-20101101-040000.gz',
        'pagecounts-20101101-050000.gz',
        'pagecounts-20101101-060001.gz',
        'pagecounts-20101101-070000.gz',
        'pagecounts-20101101-080000.gz',
        'pagecounts-20101101-090000.gz',
        'pagecounts-20101101-100000.gz',
        'pagecounts-20101101-110000.gz',
        'pagecounts-20101101-120000.gz',
        'pagecounts-20101101-130000.gz',
        'pagecounts-20101101-140000.gz',
        'pagecounts-20101101-150000.gz',
        'pagecounts-20101101-160000.gz',
        'pagecounts-20101101-170000.gz',
        'pagecounts-20101101-180001.gz',
        'pagecounts-20101101-190000.gz',
        'pagecounts-20101101-200000.gz',
        'pagecounts-20101101-210000.gz',
        'pagecounts-20101101-220000.gz',
        'pagecounts-20101101-230000.gz',
        'pagecounts-20101102-000000.gz',
        'pagecounts-20101102-010000.gz',
        'pagecounts-20101102-020000.gz',
        'pagecounts-20101102-030000.gz',
        'pagecounts-20101102-040000.gz',
        'pagecounts-20101102-050000.gz',
        'pagecounts-20101102-060001.gz',
        'pagecounts-20101102-070000.gz',
        'pagecounts-20101102-080000.gz',
        'pagecounts-20101102-090000.gz',
        'pagecounts-20101102-100000.gz',
        'pagecounts-20101102-110000.gz',
        'pagecounts-20101102-120000.gz',
        'pagecounts-20101102-130000.gz',
        'pagecounts-20101102-140000.gz',
        'pagecounts-20101102-150000.gz',
        'pagecounts-20101102-160000.gz',
        'pagecounts-20101102-170001.gz',
        'pagecounts-20101102-180000.gz',
        'pagecounts-20101102-190000.gz',
        'pagecounts-20101102-200000.gz',
        'pagecounts-20101102-210000.gz',
        'pagecounts-20101102-220000.gz',
        'pagecounts-20101102-230000.gz',
        'pagecounts-20101103-000000.gz',
        'pagecounts-20101103-010000.gz',
        'pagecounts-20101103-020000.gz',
        'pagecounts-20101103-030000.gz',
        'pagecounts-20101103-040000.gz',
        'pagecounts-20101103-050001.gz',
        'pagecounts-20101103-060000.gz',
        'pagecounts-20101103-070000.gz',
        'pagecounts-20101103-080000.gz',
        'pagecounts-20101103-090000.gz',
        'pagecounts-20101103-100000.gz',
        'pagecounts-20101103-110000.gz',
        'pagecounts-20101103-120000.gz',
        'pagecounts-20101103-130000.gz',
        'pagecounts-20101103-140000.gz',
        'pagecounts-20101103-150000.gz',
        'pagecounts-20101103-160000.gz',
        'pagecounts-20101103-170000.gz',
        'pagecounts-20101103-180001.gz',
        'pagecounts-20101103-190000.gz',
        'pagecounts-20101103-200000.gz',
        'pagecounts-20101103-210000.gz',
        'pagecounts-20101103-220000.gz',
        'pagecounts-20101103-230000.gz',
        'pagecounts-20101104-000000.gz',
        'pagecounts-20101104-010000.gz',
        'pagecounts-20101104-020000.gz',
        'pagecounts-20101104-030000.gz',
        'pagecounts-20101104-040000.gz',
        'pagecounts-20101104-050000.gz',
        'pagecounts-20101104-060000.gz',
        'pagecounts-20101104-070000.gz',
        'pagecounts-20101104-080001.gz',
        'pagecounts-20101104-090000.gz',
        'pagecounts-20101104-100000.gz',
        'pagecounts-20101104-110000.gz',
        'pagecounts-20101104-120000.gz',
        'pagecounts-20101104-130000.gz',
        'pagecounts-20101104-140000.gz',
        'pagecounts-20101104-150000.gz',
        'pagecounts-20101104-160000.gz',
        'pagecounts-20101104-170000.gz',
        'pagecounts-20101104-180000.gz',
        'pagecounts-20101104-190000.gz',
        'pagecounts-20101104-200001.gz',
        'pagecounts-20101104-210000.gz',
        'pagecounts-20101104-220000.gz',
        'pagecounts-20101104-230000.gz',
        'pagecounts-20101105-000000.gz',
        'pagecounts-20101105-010000.gz',
        'pagecounts-20101105-020000.gz',
        'pagecounts-20101105-030000.gz',
        'pagecounts-20101105-040000.gz',
        'pagecounts-20101105-050000.gz',
        'pagecounts-20101105-060000.gz',
        'pagecounts-20101105-070000.gz',
        'pagecounts-20101105-080000.gz',
        'pagecounts-20101105-090001.gz',
        'pagecounts-20101105-100000.gz',
        'pagecounts-20101105-110000.gz',
        'pagecounts-20101105-120000.gz',
        'pagecounts-20101105-130000.gz',
        'pagecounts-20101105-140000.gz',
        'pagecounts-20101105-150000.gz',
        'pagecounts-20101105-160000.gz',
        'pagecounts-20101105-170000.gz',
        'pagecounts-20101105-180000.gz',
        'pagecounts-20101105-190000.gz',
        'pagecounts-20101105-200000.gz',
        'pagecounts-20101105-210001.gz',
        'pagecounts-20101105-220000.gz',
        'pagecounts-20101105-230000.gz',
        'pagecounts-20101106-000000.gz',
        'pagecounts-20101106-010000.gz',
        'pagecounts-20101106-020000.gz',
        'pagecounts-20101106-030000.gz',
        'pagecounts-20101106-040000.gz',
        'pagecounts-20101106-050000.gz',
        'pagecounts-20101106-060000.gz',
        'pagecounts-20101106-070000.gz',
        'pagecounts-20101106-080000.gz',
        'pagecounts-20101106-090000.gz',
        'pagecounts-20101106-100000.gz',
        'pagecounts-20101106-110001.gz',
        'pagecounts-20101106-120000.gz',
        'pagecounts-20101106-130000.gz',
        'pagecounts-20101106-140000.gz',
        'pagecounts-20101106-150000.gz',
        'pagecounts-20101106-160000.gz',
        'pagecounts-20101106-170000.gz',
        'pagecounts-20101106-180000.gz',
        'pagecounts-20101106-190000.gz',
        'pagecounts-20101106-200000.gz',
        'pagecounts-20101106-210000.gz',
        'pagecounts-20101106-220001.gz',
        'pagecounts-20101106-230000.gz',
        'pagecounts-20101107-000000.gz',
        'pagecounts-20101107-010000.gz',
        'pagecounts-20101107-020000.gz',
        'pagecounts-20101107-030000.gz',
        'pagecounts-20101107-040000.gz',
        'pagecounts-20101107-050000.gz',
        'pagecounts-20101107-060000.gz',
        'pagecounts-20101107-070000.gz',
        'pagecounts-20101107-080000.gz',
        'pagecounts-20101107-090000.gz',
        'pagecounts-20101107-100000.gz',
        'pagecounts-20101107-110000.gz',
        'pagecounts-20101107-120001.gz',
        'pagecounts-20101107-130000.gz',
        'pagecounts-20101107-140000.gz',
        'pagecounts-20101107-150000.gz',
        'pagecounts-20101107-160000.gz',
        'pagecounts-20101107-170000.gz',
        'pagecounts-20101107-180000.gz',
        'pagecounts-20101107-190000.gz',
        'pagecounts-20101107-200000.gz',
        'pagecounts-20101107-210000.gz',
        'pagecounts-20101107-220000.gz',
        'pagecounts-20101107-230001.gz',
        'pagecounts-20101108-000000.gz',
        'pagecounts-20101108-010000.gz',
        'pagecounts-20101108-020000.gz',
        'pagecounts-20101108-030000.gz',
        'pagecounts-20101108-040000.gz',
        'pagecounts-20101108-050000.gz',
        'pagecounts-20101108-060000.gz',
        'pagecounts-20101108-070000.gz',
        'pagecounts-20101108-080000.gz',
        'pagecounts-20101108-090000.gz',
        'pagecounts-20101108-100000.gz',
        'pagecounts-20101108-110000.gz',
        'pagecounts-20101108-120001.gz',
        'pagecounts-20101108-130000.gz',
        'pagecounts-20101108-140000.gz',
        'pagecounts-20101108-150000.gz',
        'pagecounts-20101108-160000.gz',
        'pagecounts-20101108-170000.gz',
        'pagecounts-20101108-180000.gz',
        'pagecounts-20101108-190000.gz',
        'pagecounts-20101108-200000.gz',
        'pagecounts-20101108-210000.gz',
        'pagecounts-20101108-220000.gz',
        'pagecounts-20101108-230001.gz',
        'pagecounts-20101109-000000.gz',
        'pagecounts-20101109-010000.gz',
        'pagecounts-20101109-020000.gz',
        'pagecounts-20101109-030000.gz',
        'pagecounts-20101109-040000.gz',
        'pagecounts-20101109-050000.gz',
        'pagecounts-20101109-060000.gz',
        'pagecounts-20101109-070000.gz',
        'pagecounts-20101109-080000.gz',
        'pagecounts-20101109-090000.gz',
        'pagecounts-20101109-100000.gz',
        'pagecounts-20101109-110000.gz',
        'pagecounts-20101109-120000.gz',
        'pagecounts-20101109-130001.gz',
        'pagecounts-20101109-140000.gz',
        'pagecounts-20101109-150000.gz',
        'pagecounts-20101109-160000.gz',
        'pagecounts-20101109-170000.gz',
        'pagecounts-20101109-180000.gz',
        'pagecounts-20101109-190000.gz',
        'pagecounts-20101109-200000.gz',
        'pagecounts-20101109-210000.gz',
        'pagecounts-20101109-220000.gz',
        'pagecounts-20101109-230000.gz',
        'pagecounts-20101110-000000.gz',
        'pagecounts-20101110-010001.gz',
        'pagecounts-20101110-020000.gz',
        'pagecounts-20101110-030000.gz',
        'pagecounts-20101110-040000.gz',
        'pagecounts-20101110-050000.gz',
        'pagecounts-20101110-060000.gz',
        'pagecounts-20101110-070000.gz',
        'pagecounts-20101110-080000.gz',
        'pagecounts-20101110-090000.gz',
        'pagecounts-20101110-100000.gz',
        'pagecounts-20101110-110000.gz',
        'pagecounts-20101110-120000.gz',
        'pagecounts-20101110-130000.gz',
        'pagecounts-20101110-140000.gz',
        'pagecounts-20101110-150001.gz',
        'pagecounts-20101110-160000.gz',
        'pagecounts-20101110-170000.gz',
        'pagecounts-20101110-180000.gz',
        'pagecounts-20101110-190000.gz',
        'pagecounts-20101110-200000.gz',
        'pagecounts-20101110-210000.gz',
        'pagecounts-20101110-220000.gz',
        'pagecounts-20101110-230000.gz',
        'pagecounts-20101111-000000.gz',
        'pagecounts-20101111-010000.gz',
        'pagecounts-20101111-020000.gz',
        'pagecounts-20101111-030001.gz',
        'pagecounts-20101111-040000.gz',
        'pagecounts-20101111-050000.gz',
        'pagecounts-20101111-060000.gz',
        'pagecounts-20101111-070000.gz',
        'pagecounts-20101111-080000.gz',
        'pagecounts-20101111-090000.gz',
        'pagecounts-20101111-100000.gz',
        'pagecounts-20101111-110000.gz',
        'pagecounts-20101111-120000.gz',
        'pagecounts-20101111-130000.gz',
        'pagecounts-20101111-140000.gz',
        'pagecounts-20101111-150000.gz',
        'pagecounts-20101111-160001.gz',
        'pagecounts-20101111-170000.gz',
        'pagecounts-20101111-180000.gz',
        'pagecounts-20101111-190000.gz',
        'pagecounts-20101111-200000.gz',
        'pagecounts-20101111-210000.gz',
        'pagecounts-20101111-220000.gz',
        'pagecounts-20101111-230000.gz',
        'pagecounts-20101112-000000.gz',
        'pagecounts-20101112-010000.gz',
        'pagecounts-20101112-020000.gz',
        'pagecounts-20101112-030000.gz',
        'pagecounts-20101112-040001.gz',
        'pagecounts-20101112-050000.gz',
        'pagecounts-20101112-060000.gz',
        'pagecounts-20101112-070000.gz',
        'pagecounts-20101112-080000.gz',
        'pagecounts-20101112-090000.gz',
        'pagecounts-20101112-100000.gz',
        'pagecounts-20101112-110000.gz',
        'pagecounts-20101112-120000.gz',
        'pagecounts-20101112-130000.gz',
        'pagecounts-20101112-140000.gz',
        'pagecounts-20101112-150000.gz',
        'pagecounts-20101112-160000.gz',
        'pagecounts-20101112-170001.gz',
        'pagecounts-20101112-180000.gz',
        'pagecounts-20101112-190000.gz',
        'pagecounts-20101112-200000.gz',
        'pagecounts-20101112-210000.gz',
        'pagecounts-20101112-220000.gz',
        'pagecounts-20101112-230000.gz',
        'pagecounts-20101113-000000.gz',
        'pagecounts-20101113-010000.gz',
        'pagecounts-20101113-020000.gz',
        'pagecounts-20101113-030000.gz',
        'pagecounts-20101113-040000.gz',
        'pagecounts-20101113-050000.gz',
        'pagecounts-20101113-060001.gz',
        'pagecounts-20101113-070000.gz',
        'pagecounts-20101113-080000.gz',
        'pagecounts-20101113-090000.gz',
        'pagecounts-20101113-100000.gz',
        'pagecounts-20101113-110000.gz',
        'pagecounts-20101113-120000.gz',
        'pagecounts-20101113-130000.gz',
        'pagecounts-20101113-140000.gz',
        'pagecounts-20101113-150000.gz',
        'pagecounts-20101113-160000.gz',
        'pagecounts-20101113-170000.gz',
        'pagecounts-20101113-180001.gz',
        'pagecounts-20101113-190000.gz',
        'pagecounts-20101113-200000.gz',
        'pagecounts-20101113-210000.gz',
        'pagecounts-20101113-220000.gz',
        'pagecounts-20101113-230000.gz',
        'pagecounts-20101114-000000.gz',
        'pagecounts-20101114-010000.gz',
        'pagecounts-20101114-020000.gz',
        'pagecounts-20101114-030000.gz',
        'pagecounts-20101114-040000.gz',
        'pagecounts-20101114-050000.gz',
        'pagecounts-20101114-060000.gz',
        'pagecounts-20101114-070000.gz',
        'pagecounts-20101114-080001.gz',
        'pagecounts-20101114-090000.gz',
        'pagecounts-20101114-100000.gz',
        'pagecounts-20101114-110000.gz',
        'pagecounts-20101114-120000.gz',
        'pagecounts-20101114-130000.gz',
        'pagecounts-20101114-140000.gz',
        'pagecounts-20101114-150000.gz',
        'pagecounts-20101114-160000.gz',
        'pagecounts-20101114-170000.gz',
        'pagecounts-20101114-180000.gz',
        'pagecounts-20101114-190000.gz',
        'pagecounts-20101114-200001.gz',
        'pagecounts-20101114-210000.gz',
        'pagecounts-20101114-220000.gz',
        'pagecounts-20101114-230000.gz',
        'pagecounts-20101115-000000.gz',
        'pagecounts-20101115-010000.gz',
        'pagecounts-20101115-020000.gz',
        'pagecounts-20101115-030000.gz',
        'pagecounts-20101115-040000.gz',
        'pagecounts-20101115-050000.gz',
        'pagecounts-20101115-060000.gz',
        'pagecounts-20101115-070000.gz',
        'pagecounts-20101115-080000.gz',
        'pagecounts-20101115-090000.gz',
        'pagecounts-20101115-100001.gz',
        'pagecounts-20101115-110000.gz',
        'pagecounts-20101115-120000.gz',
        'pagecounts-20101115-130000.gz',
        'pagecounts-20101115-140000.gz',
        'pagecounts-20101115-150000.gz',
        'pagecounts-20101115-160000.gz',
        'pagecounts-20101115-170000.gz',
        'pagecounts-20101115-180000.gz',
        'pagecounts-20101115-190000.gz',
        'pagecounts-20101115-200000.gz',
        'pagecounts-20101115-210000.gz',
        'pagecounts-20101115-220000.gz',
        'pagecounts-20101115-230001.gz',
        'pagecounts-20101116-000000.gz',
        'pagecounts-20101116-010000.gz',
        'pagecounts-20101116-020000.gz',
        'pagecounts-20101116-030000.gz',
        'pagecounts-20101116-040000.gz',
        'pagecounts-20101116-050000.gz',
        'pagecounts-20101116-060000.gz',
        'pagecounts-20101116-070000.gz',
        'pagecounts-20101116-080000.gz',
        'pagecounts-20101116-090000.gz',
        'pagecounts-20101116-100000.gz',
        'pagecounts-20101116-110000.gz',
        'pagecounts-20101116-120000.gz',
        'pagecounts-20101116-130001.gz',
        'pagecounts-20101116-140000.gz',
        'pagecounts-20101116-150000.gz',
        'pagecounts-20101116-160000.gz',
        'pagecounts-20101116-170000.gz',
        'pagecounts-20101116-180000.gz',
        'pagecounts-20101116-190000.gz',
        'pagecounts-20101116-200000.gz',
        'pagecounts-20101116-210000.gz',
        'pagecounts-20101116-220000.gz',
        'pagecounts-20101116-230000.gz',
        'pagecounts-20101117-000000.gz',
        'pagecounts-20101117-010000.gz',
        'pagecounts-20101117-020000.gz',
        'pagecounts-20101117-030001.gz',
        'pagecounts-20101117-040000.gz',
        'pagecounts-20101117-050000.gz',
        'pagecounts-20101117-060000.gz',
        'pagecounts-20101117-070000.gz',
        'pagecounts-20101117-080000.gz',
        'pagecounts-20101117-090000.gz',
        'pagecounts-20101117-100000.gz',
        'pagecounts-20101117-110000.gz',
        'pagecounts-20101117-120000.gz',
        'pagecounts-20101117-130000.gz',
        'pagecounts-20101117-140000.gz',
        'pagecounts-20101117-150000.gz',
        'pagecounts-20101117-160001.gz',
        'pagecounts-20101117-170000.gz',
        'pagecounts-20101117-180000.gz',
        'pagecounts-20101117-190000.gz',
        'pagecounts-20101117-200000.gz',
        'pagecounts-20101117-210000.gz',
        'pagecounts-20101117-220000.gz',
        'pagecounts-20101117-230000.gz',
        'pagecounts-20101118-000000.gz',
        'pagecounts-20101118-010000.gz',
        'pagecounts-20101118-020000.gz',
        'pagecounts-20101118-030000.gz',
        'pagecounts-20101118-040000.gz',
        'pagecounts-20101118-050001.gz',
        'pagecounts-20101118-060000.gz',
        'pagecounts-20101118-070000.gz',
        'pagecounts-20101118-080000.gz',
        'pagecounts-20101118-090000.gz',
        'pagecounts-20101118-100000.gz',
        'pagecounts-20101118-110000.gz',
        'pagecounts-20101118-120000.gz',
        'pagecounts-20101118-130000.gz',
        'pagecounts-20101118-140000.gz',
        'pagecounts-20101118-150000.gz',
        'pagecounts-20101118-160000.gz',
        'pagecounts-20101118-170001.gz',
        'pagecounts-20101118-180000.gz',
        'pagecounts-20101118-190000.gz',
        'pagecounts-20101118-200000.gz',
        'pagecounts-20101118-210000.gz',
        'pagecounts-20101118-220000.gz',
        'pagecounts-20101118-230000.gz',
        'pagecounts-20101119-000000.gz',
        'pagecounts-20101119-010000.gz',
        'pagecounts-20101119-020000.gz',
        'pagecounts-20101119-030000.gz',
        'pagecounts-20101119-040001.gz',
        'pagecounts-20101119-050000.gz',
        'pagecounts-20101119-060000.gz',
        'pagecounts-20101119-070000.gz',
        'pagecounts-20101119-080000.gz',
        'pagecounts-20101119-090000.gz',
        'pagecounts-20101119-100000.gz',
        'pagecounts-20101119-110000.gz',
        'pagecounts-20101119-120000.gz',
        'pagecounts-20101119-130000.gz',
        'pagecounts-20101119-140000.gz',
        'pagecounts-20101119-150000.gz',
        'pagecounts-20101119-160000.gz',
        'pagecounts-20101119-170001.gz',
        'pagecounts-20101119-180000.gz',
        'pagecounts-20101119-190000.gz',
        'pagecounts-20101119-200000.gz',
        'pagecounts-20101119-210000.gz',
        'pagecounts-20101119-220000.gz',
        'pagecounts-20101119-230000.gz',
        'pagecounts-20101120-000000.gz',
        'pagecounts-20101120-010000.gz',
        'pagecounts-20101120-020000.gz',
        'pagecounts-20101120-030000.gz',
        'pagecounts-20101120-040000.gz',
        'pagecounts-20101120-050000.gz',
        'pagecounts-20101120-060001.gz',
        'pagecounts-20101120-070000.gz',
        'pagecounts-20101120-080000.gz',
        'pagecounts-20101120-090000.gz',
        'pagecounts-20101120-100000.gz',
        'pagecounts-20101120-110000.gz',
        'pagecounts-20101120-120000.gz',
        'pagecounts-20101120-130000.gz',
        'pagecounts-20101120-140000.gz',
        'pagecounts-20101120-150000.gz',
        'pagecounts-20101120-160000.gz',
        'pagecounts-20101120-170000.gz',
        'pagecounts-20101120-180000.gz',
        'pagecounts-20101120-190001.gz',
        'pagecounts-20101120-200000.gz',
        'pagecounts-20101120-210000.gz',
        'pagecounts-20101120-220000.gz',
        'pagecounts-20101120-230000.gz',
        'pagecounts-20101121-000000.gz',
        'pagecounts-20101121-010000.gz',
        'pagecounts-20101121-020000.gz',
        'pagecounts-20101121-030000.gz',
        'pagecounts-20101121-040000.gz',
        'pagecounts-20101121-050000.gz',
        'pagecounts-20101121-060000.gz',
        'pagecounts-20101121-070000.gz',
        'pagecounts-20101121-080000.gz',
        'pagecounts-20101121-090001.gz',
        'pagecounts-20101121-100000.gz',
        'pagecounts-20101121-110000.gz',
        'pagecounts-20101121-120000.gz',
        'pagecounts-20101121-130000.gz',
        'pagecounts-20101121-140000.gz',
        'pagecounts-20101121-150000.gz',
        'pagecounts-20101121-160000.gz',
        'pagecounts-20101121-170000.gz',
        'pagecounts-20101121-180000.gz',
        'pagecounts-20101121-190000.gz',
        'pagecounts-20101121-200001.gz',
        'pagecounts-20101121-210000.gz',
        'pagecounts-20101121-220000.gz',
        'pagecounts-20101121-230000.gz',
        'pagecounts-20101122-000000.gz',
        'pagecounts-20101122-010000.gz',
        'pagecounts-20101122-020000.gz',
        'pagecounts-20101122-030000.gz',
        'pagecounts-20101122-040000.gz',
        'pagecounts-20101122-050000.gz',
        'pagecounts-20101122-060000.gz',
        'pagecounts-20101122-070000.gz',
        'pagecounts-20101122-080000.gz',
        'pagecounts-20101122-090000.gz',
        'pagecounts-20101122-100001.gz',
        'pagecounts-20101122-110000.gz',
        'pagecounts-20101122-120000.gz',
        'pagecounts-20101122-130000.gz',
        'pagecounts-20101122-140000.gz',
        'pagecounts-20101122-150000.gz',
        'pagecounts-20101122-160000.gz',
        'pagecounts-20101122-170000.gz',
        'pagecounts-20101122-180000.gz',
        'pagecounts-20101122-190000.gz',
        'pagecounts-20101122-200000.gz',
        'pagecounts-20101122-210001.gz',
        'pagecounts-20101122-220000.gz',
        'pagecounts-20101122-230000.gz',
        'pagecounts-20101123-000000.gz',
        'pagecounts-20101123-010000.gz',
        'pagecounts-20101123-020000.gz',
        'pagecounts-20101123-030000.gz',
        'pagecounts-20101123-040000.gz',
        'pagecounts-20101123-050000.gz',
        'pagecounts-20101123-060000.gz',
        'pagecounts-20101123-070000.gz',
        'pagecounts-20101123-080000.gz',
        'pagecounts-20101123-090000.gz',
        'pagecounts-20101123-100000.gz',
        'pagecounts-20101123-110001.gz',
        'pagecounts-20101123-120000.gz',
        'pagecounts-20101123-130000.gz',
        'pagecounts-20101123-140000.gz',
        'pagecounts-20101123-150000.gz',
        'pagecounts-20101123-160000.gz',
        'pagecounts-20101123-170000.gz',
        'pagecounts-20101123-180000.gz',
        'pagecounts-20101123-190000.gz',
        'pagecounts-20101123-200000.gz',
        'pagecounts-20101123-210000.gz',
        'pagecounts-20101123-220001.gz',
        'pagecounts-20101123-230000.gz',
        'pagecounts-20101124-000000.gz',
        'pagecounts-20101124-010000.gz',
        'pagecounts-20101124-020000.gz',
        'pagecounts-20101124-030000.gz',
        'pagecounts-20101124-040000.gz',
        'pagecounts-20101124-050000.gz',
        'pagecounts-20101124-060000.gz',
        'pagecounts-20101124-070000.gz',
        'pagecounts-20101124-080000.gz',
        'pagecounts-20101124-090000.gz',
        'pagecounts-20101124-100000.gz',
        'pagecounts-20101124-110001.gz',
        'pagecounts-20101124-120000.gz',
        'pagecounts-20101124-130000.gz',
        'pagecounts-20101124-140000.gz',
        'pagecounts-20101124-150000.gz',
        'pagecounts-20101124-160000.gz',
        'pagecounts-20101124-170000.gz',
        'pagecounts-20101124-180000.gz',
        'pagecounts-20101124-190000.gz',
        'pagecounts-20101124-200000.gz',
        'pagecounts-20101124-210000.gz',
        'pagecounts-20101124-220001.gz',
        'pagecounts-20101124-230000.gz',
        'pagecounts-20101125-000000.gz',
        'pagecounts-20101125-010000.gz',
        'pagecounts-20101125-020000.gz',
        'pagecounts-20101125-030000.gz',
        'pagecounts-20101125-040000.gz',
        'pagecounts-20101125-050000.gz',
        'pagecounts-20101125-060000.gz',
        'pagecounts-20101125-070000.gz',
        'pagecounts-20101125-080000.gz',
        'pagecounts-20101125-090000.gz',
        'pagecounts-20101125-100000.gz',
        'pagecounts-20101125-110001.gz',
        'pagecounts-20101125-120000.gz',
        'pagecounts-20101125-130000.gz',
        'pagecounts-20101125-140000.gz',
        'pagecounts-20101125-150000.gz',
        'pagecounts-20101125-160000.gz',
        'pagecounts-20101125-170000.gz',
        'pagecounts-20101125-180000.gz',
        'pagecounts-20101125-190000.gz',
        'pagecounts-20101125-200000.gz',
        'pagecounts-20101125-210000.gz',
        'pagecounts-20101125-220001.gz',
        'pagecounts-20101125-230000.gz',
        'pagecounts-20101126-000000.gz',
        'pagecounts-20101126-010000.gz',
        'pagecounts-20101126-020000.gz',
        'pagecounts-20101126-030000.gz',
        'pagecounts-20101126-040000.gz',
        'pagecounts-20101126-050000.gz',
        'pagecounts-20101126-060000.gz',
        'pagecounts-20101126-070000.gz',
        'pagecounts-20101126-080000.gz',
        'pagecounts-20101126-090000.gz',
        'pagecounts-20101126-100000.gz',
        'pagecounts-20101126-110000.gz',
        'pagecounts-20101126-120001.gz',
        'pagecounts-20101126-130000.gz',
        'pagecounts-20101126-140000.gz',
        'pagecounts-20101126-150000.gz',
        'pagecounts-20101126-160000.gz',
        'pagecounts-20101126-170000.gz',
        'pagecounts-20101126-180000.gz',
        'pagecounts-20101126-190000.gz',
        'pagecounts-20101126-200000.gz',
        'pagecounts-20101126-210000.gz',
        'pagecounts-20101126-220000.gz',
        'pagecounts-20101126-230001.gz',
        'pagecounts-20101127-000000.gz',
        'pagecounts-20101127-010000.gz',
        'pagecounts-20101127-020000.gz',
        'pagecounts-20101127-030000.gz',
        'pagecounts-20101127-040000.gz',
        'pagecounts-20101127-050000.gz',
        'pagecounts-20101127-060000.gz',
        'pagecounts-20101127-070000.gz',
        'pagecounts-20101127-080000.gz',
        'pagecounts-20101127-090000.gz',
        'pagecounts-20101127-100000.gz',
        'pagecounts-20101127-110000.gz',
        'pagecounts-20101127-120001.gz',
        'pagecounts-20101127-130000.gz',
        'pagecounts-20101127-140000.gz',
        'pagecounts-20101127-150000.gz',
        'pagecounts-20101127-160000.gz',
        'pagecounts-20101127-170000.gz',
        'pagecounts-20101127-180000.gz',
        'pagecounts-20101127-190000.gz',
        'pagecounts-20101127-200000.gz',
        'pagecounts-20101127-210000.gz',
        'pagecounts-20101127-220000.gz',
        'pagecounts-20101127-230001.gz',
        'pagecounts-20101128-000000.gz',
        'pagecounts-20101128-010000.gz',
        'pagecounts-20101128-020000.gz',
        'pagecounts-20101128-030000.gz',
        'pagecounts-20101128-040000.gz',
        'pagecounts-20101128-050000.gz',
        'pagecounts-20101128-060000.gz',
        'pagecounts-20101128-070000.gz',
        'pagecounts-20101128-080000.gz',
        'pagecounts-20101128-090000.gz',
        'pagecounts-20101128-100000.gz',
        'pagecounts-20101128-110000.gz',
        'pagecounts-20101128-120000.gz',
        'pagecounts-20101128-130001.gz',
        'pagecounts-20101128-140000.gz',
        'pagecounts-20101128-150000.gz',
        'pagecounts-20101128-160000.gz',
        'pagecounts-20101128-170000.gz',
        'pagecounts-20101128-180000.gz',
        'pagecounts-20101128-190000.gz',
        'pagecounts-20101128-200000.gz',
        'pagecounts-20101128-210000.gz',
        'pagecounts-20101128-220000.gz',
        'pagecounts-20101128-230000.gz',
        'pagecounts-20101129-000001.gz',
        'pagecounts-20101129-010000.gz',
        'pagecounts-20101129-020000.gz',
        'pagecounts-20101129-030000.gz',
        'pagecounts-20101129-040000.gz',
        'pagecounts-20101129-050000.gz',
        'pagecounts-20101129-060000.gz',
        'pagecounts-20101129-070000.gz',
        'pagecounts-20101129-080000.gz',
        'pagecounts-20101129-090000.gz',
        'pagecounts-20101129-100000.gz',
        'pagecounts-20101129-110000.gz',
        'pagecounts-20101129-120000.gz',
        'pagecounts-20101129-130001.gz',
        'pagecounts-20101129-140000.gz',
        'pagecounts-20101129-150000.gz',
        'pagecounts-20101129-160000.gz',
        'pagecounts-20101129-170000.gz',
        'pagecounts-20101129-180000.gz',
        'pagecounts-20101129-190000.gz',
        'pagecounts-20101129-200000.gz',
        'pagecounts-20101129-210000.gz',
        'pagecounts-20101129-220000.gz',
        'pagecounts-20101129-230000.gz',
        'pagecounts-20101130-000001.gz',
        'pagecounts-20101130-010000.gz',
        'pagecounts-20101130-020000.gz',
        'pagecounts-20101130-030000.gz',
        'pagecounts-20101130-040000.gz',
        'pagecounts-20101130-050000.gz',
        'pagecounts-20101130-060000.gz',
        'pagecounts-20101130-070000.gz',
        'pagecounts-20101130-080000.gz',
        'pagecounts-20101130-090000.gz',
        'pagecounts-20101130-100000.gz',
        'pagecounts-20101130-110000.gz',
        'pagecounts-20101130-120000.gz',
        'pagecounts-20101130-130001.gz'
    ]

    # md5 checksum hashes to python
    dt_md5 = 'md5sums.txt'
    dt_pd_md5 = pd.read_table(os.path.dirname(os.path.realpath(__file__)) + sl + dt_md5, delim_whitespace=True,
                              header=None, names=['md5', 'fname'], index_col=1)

    dt_pd_wiki_legacy = pd.DataFrame(columns=['project', 'page_title', 'counter', 'rsize', 'tstamp'])
    # dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])
    dt_pd_wiki_legacy.set_index('page_title', inplace=True, drop=True, append=False, verify_integrity=True)

    t = 0
    for x in files:
        if hashlib.md5(open(x, 'rb').read()).hexdigest() == dt_pd_md5.loc[x]['md5']:
            print('md5 match')
            f = gzip.open(x, 'rb')
            file_content = f.read()
            wframe = pd.read_table(gzip.open(x), sep=' ', usecols=[0, 1, 2, 3], names=['project', 'page_title', 'counter', 'rsize'], index_col=['page_title'])
            f.close()
            try:
                wframe = wframe.loc['Bitcoin']
                # wframe['tstamp'] = pd.to_datetime(dt.datetime.strptime(x[11:-3], "%Y%m%d-%H%M%S"))
                wframe['tstamp'] = x[11:-3]
                dt_pd_wiki_legacy = dt_pd_wiki_legacy.append(wframe)
                dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])
                print('----------------------------')
                print(t)
                print('progres: ', (t / len(files))*100,"%")
                dt_pd_wiki_legacy.to_pickle('dt_pd_wiki_legacy.pickle')
                t = t + 1
            except Exception:
                print('error in: ',x)
        else:
            print('------------------------------------------------------')
            print('MD5 error in file', x)
            print('------------------------------------------------------')

    # dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])

    print('current cycle of scraping done')

if __name__ == '__main__':
    main()
else:
    print("Run From Import")