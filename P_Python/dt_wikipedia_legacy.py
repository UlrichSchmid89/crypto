# https://pypi.python.org/pypi/mwviews
# https://github.com/Commonists/pageview-api
# https://wikimedia.org/api/rest_v1/#!/Pageviews_data/get_metrics_pageviews_per_article_project_access_agent_article_granularity_start_end
# actual (not legacy) https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/bitcoin/daily/2010071800/20181124

# https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/bitcoin/daily/2010071800/20181124
# https://wikitech.wikimedia.org/wiki/Analytics/Pageviews
# https://wikitech.wikimedia.org/wiki/Analytics/Systems/Dashiki
# https://github.com/abelsson/stats.grok.se/blob/master/backend/getstats.py
# https://dumps.wikimedia.org/other/pagecounts-raw/
# https://dumps.wikimedia.org/other/pagecounts-ez/

import gzip
import os
# from tkinter import Tk
import scipy
import datetime as dt
print('scipy: %s' % scipy.__version__)
import numpy as np
print('numpy: %s' % np.__version__)
import pandas as pd
import hashlib
print('pandas: %s' % pd.__version__)
import io

print(os.getcwd())

def main():
    print("First Module's Name: {}".format(__name__))

    if os.name == 'posix':
        sl = '/'
    elif os.name == 'nt':
        sl = '\\'

    # All Files to be read in current cycle of scraping
    files = [
        'pagecounts-20101201-000001.gz',
        'pagecounts-20101201-010000.gz',
        'pagecounts-20101201-020000.gz',
        'pagecounts-20101201-030000.gz',
        'pagecounts-20101201-040000.gz',
        'pagecounts-20101201-050000.gz',
        'pagecounts-20101201-060000.gz',
        'pagecounts-20101201-070000.gz',
        'pagecounts-20101201-080000.gz',
        'pagecounts-20101201-090000.gz',
        'pagecounts-20101201-100000.gz',
        'pagecounts-20101201-110000.gz',
        'pagecounts-20101201-120000.gz',
        'pagecounts-20101201-130001.gz',
        'pagecounts-20101201-140000.gz',
        'pagecounts-20101201-150000.gz',
        'pagecounts-20101201-160000.gz',
        'pagecounts-20101201-170000.gz',
        'pagecounts-20101201-180000.gz',
        'pagecounts-20101201-190000.gz',
        'pagecounts-20101201-200000.gz',
        'pagecounts-20101201-210000.gz',
        'pagecounts-20101201-220000.gz',
        'pagecounts-20101201-230000.gz',
        'pagecounts-20101202-000001.gz',
        'pagecounts-20101202-010000.gz',
        'pagecounts-20101202-020000.gz',
        'pagecounts-20101202-030000.gz',
        'pagecounts-20101202-040000.gz',
        'pagecounts-20101202-050000.gz',
        'pagecounts-20101202-060000.gz',
        'pagecounts-20101202-070000.gz',
        'pagecounts-20101202-080000.gz',
        'pagecounts-20101202-090000.gz',
        'pagecounts-20101202-100000.gz',
        'pagecounts-20101202-110000.gz',
        'pagecounts-20101202-120000.gz',
        'pagecounts-20101202-130001.gz',
        'pagecounts-20101202-140000.gz',
        'pagecounts-20101202-150000.gz',
        'pagecounts-20101202-160000.gz',
        'pagecounts-20101202-170000.gz',
        'pagecounts-20101202-180000.gz',
        'pagecounts-20101202-190000.gz',
        'pagecounts-20101202-200000.gz',
        'pagecounts-20101202-210000.gz',
        'pagecounts-20101202-220000.gz',
        'pagecounts-20101202-230000.gz',
        'pagecounts-20101203-000000.gz',
        'pagecounts-20101203-010001.gz',
        'pagecounts-20101203-020000.gz',
        'pagecounts-20101203-030000.gz',
        'pagecounts-20101203-040000.gz',
        'pagecounts-20101203-050000.gz',
        'pagecounts-20101203-060000.gz',
        'pagecounts-20101203-070000.gz',
        'pagecounts-20101203-080000.gz',
        'pagecounts-20101203-090000.gz',
        'pagecounts-20101203-100000.gz',
        'pagecounts-20101203-110000.gz',
        'pagecounts-20101203-120000.gz',
        'pagecounts-20101203-130000.gz',
        'pagecounts-20101203-140001.gz',
        'pagecounts-20101203-150000.gz',
        'pagecounts-20101203-160000.gz',
        'pagecounts-20101203-170000.gz',
        'pagecounts-20101203-180000.gz',
        'pagecounts-20101203-190000.gz',
        'pagecounts-20101203-200000.gz',
        'pagecounts-20101203-210000.gz',
        'pagecounts-20101203-220000.gz',
        'pagecounts-20101203-230000.gz',
        'pagecounts-20101204-000000.gz',
        'pagecounts-20101204-010001.gz',
        'pagecounts-20101204-020000.gz',
        'pagecounts-20101204-030000.gz',
        'pagecounts-20101204-040000.gz',
        'pagecounts-20101204-050000.gz',
        'pagecounts-20101204-060000.gz',
        'pagecounts-20101204-070000.gz',
        'pagecounts-20101204-080000.gz',
        'pagecounts-20101204-090000.gz',
        'pagecounts-20101204-100000.gz',
        'pagecounts-20101204-110000.gz',
        'pagecounts-20101204-120000.gz',
        'pagecounts-20101204-130000.gz',
        'pagecounts-20101204-140001.gz',
        'pagecounts-20101204-150000.gz',
        'pagecounts-20101204-160000.gz',
        'pagecounts-20101204-170000.gz',
        'pagecounts-20101204-180000.gz',
        'pagecounts-20101204-190000.gz',
        'pagecounts-20101204-200000.gz',
        'pagecounts-20101204-210000.gz',
        'pagecounts-20101204-220000.gz',
        'pagecounts-20101204-230000.gz',
        'pagecounts-20101205-000000.gz',
        'pagecounts-20101205-010000.gz',
        'pagecounts-20101205-020001.gz',
        'pagecounts-20101205-030000.gz',
        'pagecounts-20101205-040000.gz',
        'pagecounts-20101205-050000.gz',
        'pagecounts-20101205-060000.gz',
        'pagecounts-20101205-070000.gz',
        'pagecounts-20101205-080000.gz',
        'pagecounts-20101205-090000.gz',
        'pagecounts-20101205-100000.gz',
        'pagecounts-20101205-110000.gz',
        'pagecounts-20101205-120000.gz',
        'pagecounts-20101205-130000.gz',
        'pagecounts-20101205-140001.gz',
        'pagecounts-20101205-150000.gz',
        'pagecounts-20101205-160000.gz',
        'pagecounts-20101205-170000.gz',
        'pagecounts-20101205-180000.gz',
        'pagecounts-20101205-190000.gz',
        'pagecounts-20101205-200000.gz',
        'pagecounts-20101205-210000.gz',
        'pagecounts-20101205-220000.gz',
        'pagecounts-20101205-230000.gz',
        'pagecounts-20101206-000000.gz',
        'pagecounts-20101206-010000.gz',
        'pagecounts-20101206-020001.gz',
        'pagecounts-20101206-030000.gz',
        'pagecounts-20101206-040000.gz',
        'pagecounts-20101206-050000.gz',
        'pagecounts-20101206-060000.gz',
        'pagecounts-20101206-070000.gz',
        'pagecounts-20101206-080000.gz',
        'pagecounts-20101206-090000.gz',
        'pagecounts-20101206-100000.gz',
        'pagecounts-20101206-110000.gz',
        'pagecounts-20101206-120000.gz',
        'pagecounts-20101206-130000.gz',
        'pagecounts-20101206-140001.gz',
        'pagecounts-20101206-150000.gz',
        'pagecounts-20101206-160000.gz',
        'pagecounts-20101206-170000.gz',
        'pagecounts-20101206-180000.gz',
        'pagecounts-20101206-190000.gz',
        'pagecounts-20101206-200000.gz',
        'pagecounts-20101206-210000.gz',
        'pagecounts-20101206-220000.gz',
        'pagecounts-20101206-230000.gz',
        'pagecounts-20101207-000000.gz',
        'pagecounts-20101207-010001.gz',
        'pagecounts-20101207-020000.gz',
        'pagecounts-20101207-030000.gz',
        'pagecounts-20101207-040000.gz',
        'pagecounts-20101207-050000.gz',
        'pagecounts-20101207-060000.gz',
        'pagecounts-20101207-070000.gz',
        'pagecounts-20101207-080000.gz',
        'pagecounts-20101207-090000.gz',
        'pagecounts-20101207-100000.gz',
        'pagecounts-20101207-110000.gz',
        'pagecounts-20101207-120000.gz',
        'pagecounts-20101207-130000.gz',
        'pagecounts-20101207-140000.gz',
        'pagecounts-20101207-150001.gz',
        'pagecounts-20101207-160000.gz',
        'pagecounts-20101207-170000.gz',
        'pagecounts-20101207-180000.gz',
        'pagecounts-20101207-190000.gz',
        'pagecounts-20101207-200000.gz',
        'pagecounts-20101207-210000.gz',
        'pagecounts-20101207-220000.gz',
        'pagecounts-20101207-230000.gz',
        'pagecounts-20101208-000000.gz',
        'pagecounts-20101208-010000.gz',
        'pagecounts-20101208-020000.gz',
        'pagecounts-20101208-030001.gz',
        'pagecounts-20101208-040000.gz',
        'pagecounts-20101208-050000.gz',
        'pagecounts-20101208-060000.gz',
        'pagecounts-20101208-070000.gz',
        'pagecounts-20101208-080000.gz',
        'pagecounts-20101208-090000.gz',
        'pagecounts-20101208-100000.gz',
        'pagecounts-20101208-110000.gz',
        'pagecounts-20101208-120000.gz',
        'pagecounts-20101208-130000.gz',
        'pagecounts-20101208-140000.gz',
        'pagecounts-20101208-150001.gz',
        'pagecounts-20101208-160000.gz',
        'pagecounts-20101208-170000.gz',
        'pagecounts-20101208-180000.gz',
        'pagecounts-20101208-190000.gz',
        'pagecounts-20101208-200000.gz',
        'pagecounts-20101208-210000.gz',
        'pagecounts-20101208-220000.gz',
        'pagecounts-20101208-230000.gz',
        'pagecounts-20101209-000000.gz',
        'pagecounts-20101209-010000.gz',
        'pagecounts-20101209-020000.gz',
        'pagecounts-20101209-030000.gz',
        'pagecounts-20101209-040001.gz',
        'pagecounts-20101209-050000.gz',
        'pagecounts-20101209-060000.gz',
        'pagecounts-20101209-070000.gz',
        'pagecounts-20101209-080000.gz',
        'pagecounts-20101209-090000.gz',
        'pagecounts-20101209-100000.gz',
        'pagecounts-20101209-110000.gz',
        'pagecounts-20101209-120000.gz',
        'pagecounts-20101209-130000.gz',
        'pagecounts-20101209-140000.gz',
        'pagecounts-20101209-150000.gz',
        'pagecounts-20101209-160001.gz',
        'pagecounts-20101209-170000.gz',
        'pagecounts-20101209-180000.gz',
        'pagecounts-20101209-190000.gz',
        'pagecounts-20101209-200000.gz',
        'pagecounts-20101209-210000.gz',
        'pagecounts-20101209-220000.gz',
        'pagecounts-20101209-230000.gz',
        'pagecounts-20101210-000000.gz',
        'pagecounts-20101210-010000.gz',
        'pagecounts-20101210-020000.gz',
        'pagecounts-20101210-030000.gz',
        'pagecounts-20101210-040001.gz',
        'pagecounts-20101210-050000.gz',
        'pagecounts-20101210-060000.gz',
        'pagecounts-20101210-070000.gz',
        'pagecounts-20101210-080000.gz',
        'pagecounts-20101210-090000.gz',
        'pagecounts-20101210-100000.gz',
        'pagecounts-20101210-110000.gz',
        'pagecounts-20101210-120000.gz',
        'pagecounts-20101210-130000.gz',
        'pagecounts-20101210-140000.gz',
        'pagecounts-20101210-150000.gz',
        'pagecounts-20101210-160001.gz',
        'pagecounts-20101210-170000.gz',
        'pagecounts-20101210-180000.gz',
        'pagecounts-20101210-190000.gz',
        'pagecounts-20101210-200000.gz',
        'pagecounts-20101210-210000.gz',
        'pagecounts-20101210-220000.gz',
        'pagecounts-20101210-230000.gz',
        'pagecounts-20101211-000000.gz',
        'pagecounts-20101211-010000.gz',
        'pagecounts-20101211-020000.gz',
        'pagecounts-20101211-030000.gz',
        'pagecounts-20101211-040000.gz',
        'pagecounts-20101211-050001.gz',
        'pagecounts-20101211-060000.gz',
        'pagecounts-20101211-070000.gz',
        'pagecounts-20101211-080000.gz',
        'pagecounts-20101211-090000.gz',
        'pagecounts-20101211-100000.gz',
        'pagecounts-20101211-110000.gz',
        'pagecounts-20101211-120000.gz',
        'pagecounts-20101211-130000.gz',
        'pagecounts-20101211-140000.gz',
        'pagecounts-20101211-150000.gz',
        'pagecounts-20101211-160000.gz',
        'pagecounts-20101211-170000.gz',
        'pagecounts-20101211-180001.gz',
        'pagecounts-20101211-190000.gz',
        'pagecounts-20101211-200000.gz',
        'pagecounts-20101211-210000.gz',
        'pagecounts-20101211-220000.gz',
        'pagecounts-20101211-230000.gz',
        'pagecounts-20101212-000000.gz',
        'pagecounts-20101212-010000.gz',
        'pagecounts-20101212-020000.gz',
        'pagecounts-20101212-030000.gz',
        'pagecounts-20101212-040000.gz',
        'pagecounts-20101212-050000.gz',
        'pagecounts-20101212-060000.gz',
        'pagecounts-20101212-070001.gz',
        'pagecounts-20101212-080000.gz',
        'pagecounts-20101212-090000.gz',
        'pagecounts-20101212-100000.gz',
        'pagecounts-20101212-110000.gz',
        'pagecounts-20101212-120000.gz',
        'pagecounts-20101212-130000.gz',
        'pagecounts-20101212-140000.gz',
        'pagecounts-20101212-150000.gz',
        'pagecounts-20101212-160000.gz',
        'pagecounts-20101212-170000.gz',
        'pagecounts-20101212-180000.gz',
        'pagecounts-20101212-190000.gz',
        'pagecounts-20101212-200001.gz',
        'pagecounts-20101212-210000.gz',
        'pagecounts-20101212-220000.gz',
        'pagecounts-20101212-230000.gz',
        'pagecounts-20101213-000000.gz',
        'pagecounts-20101213-010000.gz',
        'pagecounts-20101213-020000.gz',
        'pagecounts-20101213-030000.gz',
        'pagecounts-20101213-040000.gz',
        'pagecounts-20101213-050000.gz',
        'pagecounts-20101213-060000.gz',
        'pagecounts-20101213-070000.gz',
        'pagecounts-20101213-080001.gz',
        'pagecounts-20101213-090000.gz',
        'pagecounts-20101213-100000.gz',
        'pagecounts-20101213-110000.gz',
        'pagecounts-20101213-120000.gz',
        'pagecounts-20101213-130000.gz',
        'pagecounts-20101213-140000.gz',
        'pagecounts-20101213-150000.gz',
        'pagecounts-20101213-160000.gz',
        'pagecounts-20101213-170000.gz',
        'pagecounts-20101213-180000.gz',
        'pagecounts-20101213-190001.gz',
        'pagecounts-20101213-200000.gz',
        'pagecounts-20101213-210000.gz',
        'pagecounts-20101213-220000.gz',
        'pagecounts-20101213-230000.gz',
        'pagecounts-20101214-000000.gz',
        'pagecounts-20101214-010000.gz',
        'pagecounts-20101214-020000.gz',
        'pagecounts-20101214-030000.gz',
        'pagecounts-20101214-040000.gz',
        'pagecounts-20101214-050000.gz',
        'pagecounts-20101214-060000.gz',
        'pagecounts-20101214-070000.gz',
        'pagecounts-20101214-080000.gz',
        'pagecounts-20101214-090001.gz',
        'pagecounts-20101214-100000.gz',
        'pagecounts-20101214-110000.gz',
        'pagecounts-20101214-120000.gz',
        'pagecounts-20101214-130000.gz',
        'pagecounts-20101214-140000.gz',
        'pagecounts-20101214-150000.gz',
        'pagecounts-20101214-160000.gz',
        'pagecounts-20101214-170000.gz',
        'pagecounts-20101214-180000.gz',
        'pagecounts-20101214-190000.gz',
        'pagecounts-20101214-200001.gz',
        'pagecounts-20101214-210000.gz',
        'pagecounts-20101214-220000.gz',
        'pagecounts-20101214-230000.gz',
        'pagecounts-20101215-000000.gz',
        'pagecounts-20101215-010000.gz',
        'pagecounts-20101215-020000.gz',
        'pagecounts-20101215-030000.gz',
        'pagecounts-20101215-040000.gz',
        'pagecounts-20101215-050000.gz',
        'pagecounts-20101215-060000.gz',
        'pagecounts-20101215-070000.gz',
        'pagecounts-20101215-080001.gz',
        'pagecounts-20101215-090000.gz',
        'pagecounts-20101215-100000.gz',
        'pagecounts-20101215-110000.gz',
        'pagecounts-20101215-120000.gz',
        'pagecounts-20101215-130000.gz',
        'pagecounts-20101215-140000.gz',
        'pagecounts-20101215-150000.gz',
        'pagecounts-20101215-160000.gz',
        'pagecounts-20101215-170000.gz',
        'pagecounts-20101215-180000.gz',
        'pagecounts-20101215-190001.gz',
        'pagecounts-20101215-200000.gz',
        'pagecounts-20101215-210000.gz',
        'pagecounts-20101215-220000.gz',
        'pagecounts-20101215-230000.gz',
        'pagecounts-20101216-000000.gz',
        'pagecounts-20101216-010000.gz',
        'pagecounts-20101216-020000.gz',
        'pagecounts-20101216-030000.gz',
        'pagecounts-20101216-040000.gz',
        'pagecounts-20101216-050000.gz',
        'pagecounts-20101216-060000.gz',
        'pagecounts-20101216-070000.gz',
        'pagecounts-20101216-080001.gz',
        'pagecounts-20101216-090000.gz',
        'pagecounts-20101216-100000.gz',
        'pagecounts-20101216-110000.gz',
        'pagecounts-20101216-120000.gz',
        'pagecounts-20101216-130000.gz',
        'pagecounts-20101216-140000.gz',
        'pagecounts-20101216-150000.gz',
        'pagecounts-20101216-160000.gz',
        'pagecounts-20101216-170000.gz',
        'pagecounts-20101216-180000.gz',
        'pagecounts-20101216-190000.gz',
        'pagecounts-20101216-200001.gz',
        'pagecounts-20101216-210000.gz',
        'pagecounts-20101216-220000.gz',
        'pagecounts-20101216-230000.gz',
        'pagecounts-20101217-000000.gz',
        'pagecounts-20101217-010000.gz',
        'pagecounts-20101217-020000.gz',
        'pagecounts-20101217-030000.gz',
        'pagecounts-20101217-040000.gz',
        'pagecounts-20101217-050000.gz',
        'pagecounts-20101217-060000.gz',
        'pagecounts-20101217-070000.gz',
        'pagecounts-20101217-080000.gz',
        'pagecounts-20101217-090001.gz',
        'pagecounts-20101217-100000.gz',
        'pagecounts-20101217-110000.gz',
        'pagecounts-20101217-120000.gz',
        'pagecounts-20101217-130000.gz',
        'pagecounts-20101217-140000.gz',
        'pagecounts-20101217-150000.gz',
        'pagecounts-20101217-160000.gz',
        'pagecounts-20101217-170000.gz',
        'pagecounts-20101217-180000.gz',
        'pagecounts-20101217-190000.gz',
        'pagecounts-20101217-200001.gz',
        'pagecounts-20101217-210000.gz',
        'pagecounts-20101217-220000.gz',
        'pagecounts-20101217-230000.gz',
        'pagecounts-20101218-000000.gz',
        'pagecounts-20101218-010000.gz',
        'pagecounts-20101218-020000.gz',
        'pagecounts-20101218-030000.gz',
        'pagecounts-20101218-040000.gz',
        'pagecounts-20101218-050000.gz',
        'pagecounts-20101218-060000.gz',
        'pagecounts-20101218-070000.gz',
        'pagecounts-20101218-080000.gz',
        'pagecounts-20101218-090000.gz',
        'pagecounts-20101218-100001.gz',
        'pagecounts-20101218-110000.gz',
        'pagecounts-20101218-120000.gz',
        'pagecounts-20101218-130000.gz',
        'pagecounts-20101218-140000.gz',
        'pagecounts-20101218-150000.gz',
        'pagecounts-20101218-160000.gz',
        'pagecounts-20101218-170000.gz',
        'pagecounts-20101218-180000.gz',
        'pagecounts-20101218-190000.gz',
        'pagecounts-20101218-200001.gz',
        'pagecounts-20101218-210000.gz',
        'pagecounts-20101218-220000.gz',
        'pagecounts-20101218-230000.gz',
        'pagecounts-20101219-000000.gz',
        'pagecounts-20101219-010000.gz',
        'pagecounts-20101219-020000.gz',
        'pagecounts-20101219-030000.gz',
        'pagecounts-20101219-040000.gz',
        'pagecounts-20101219-050000.gz',
        'pagecounts-20101219-060000.gz',
        'pagecounts-20101219-070000.gz',
        'pagecounts-20101219-080000.gz',
        'pagecounts-20101219-090000.gz',
        'pagecounts-20101219-100001.gz',
        'pagecounts-20101219-110000.gz',
        'pagecounts-20101219-120000.gz',
        'pagecounts-20101219-130000.gz',
        'pagecounts-20101219-140000.gz',
        'pagecounts-20101219-150000.gz',
        'pagecounts-20101219-160000.gz',
        'pagecounts-20101219-170000.gz',
        'pagecounts-20101219-180000.gz',
        'pagecounts-20101219-190000.gz',
        'pagecounts-20101219-200001.gz',
        'pagecounts-20101219-210000.gz',
        'pagecounts-20101219-220000.gz',
        'pagecounts-20101219-230000.gz',
        'pagecounts-20101220-000000.gz',
        'pagecounts-20101220-010000.gz',
        'pagecounts-20101220-020000.gz',
        'pagecounts-20101220-030000.gz',
        'pagecounts-20101220-040000.gz',
        'pagecounts-20101220-050000.gz',
        'pagecounts-20101220-060000.gz',
        'pagecounts-20101220-070000.gz',
        'pagecounts-20101220-080001.gz',
        'pagecounts-20101220-090000.gz',
        'pagecounts-20101220-100000.gz',
        'pagecounts-20101220-110000.gz',
        'pagecounts-20101220-120000.gz',
        'pagecounts-20101220-130000.gz',
        'pagecounts-20101220-140000.gz',
        'pagecounts-20101220-150000.gz',
        'pagecounts-20101220-160000.gz',
        'pagecounts-20101220-170000.gz',
        'pagecounts-20101220-180000.gz',
        'pagecounts-20101220-190000.gz',
        'pagecounts-20101220-200001.gz',
        'pagecounts-20101220-210000.gz',
        'pagecounts-20101220-220000.gz',
        'pagecounts-20101220-230000.gz',
        'pagecounts-20101221-000000.gz',
        'pagecounts-20101221-010000.gz',
        'pagecounts-20101221-020000.gz',
        'pagecounts-20101221-030000.gz',
        'pagecounts-20101221-040000.gz',
        'pagecounts-20101221-050000.gz',
        'pagecounts-20101221-060000.gz',
        'pagecounts-20101221-070000.gz',
        'pagecounts-20101221-080000.gz',
        'pagecounts-20101221-090001.gz',
        'pagecounts-20101221-100000.gz',
        'pagecounts-20101221-110000.gz',
        'pagecounts-20101221-120000.gz',
        'pagecounts-20101221-130000.gz',
        'pagecounts-20101221-140000.gz',
        'pagecounts-20101221-150000.gz',
        'pagecounts-20101221-160000.gz',
        'pagecounts-20101221-170000.gz',
        'pagecounts-20101221-180000.gz',
        'pagecounts-20101221-190000.gz',
        'pagecounts-20101221-200000.gz',
        'pagecounts-20101221-210001.gz',
        'pagecounts-20101221-220000.gz',
        'pagecounts-20101221-230000.gz',
        'pagecounts-20101222-000000.gz',
        'pagecounts-20101222-010000.gz',
        'pagecounts-20101222-020000.gz',
        'pagecounts-20101222-030000.gz',
        'pagecounts-20101222-040000.gz',
        'pagecounts-20101222-050000.gz',
        'pagecounts-20101222-060000.gz',
        'pagecounts-20101222-070000.gz',
        'pagecounts-20101222-080000.gz',
        'pagecounts-20101222-090000.gz',
        'pagecounts-20101222-100001.gz',
        'pagecounts-20101222-110000.gz',
        'pagecounts-20101222-120000.gz',
        'pagecounts-20101222-130000.gz',
        'pagecounts-20101222-140000.gz',
        'pagecounts-20101222-150000.gz',
        'pagecounts-20101222-160000.gz',
        'pagecounts-20101222-170000.gz',
        'pagecounts-20101222-180000.gz',
        'pagecounts-20101222-190000.gz',
        'pagecounts-20101222-200000.gz',
        'pagecounts-20101222-210001.gz',
        'pagecounts-20101222-220000.gz',
        'pagecounts-20101222-230000.gz',
        'pagecounts-20101223-000000.gz',
        'pagecounts-20101223-010000.gz',
        'pagecounts-20101223-020000.gz',
        'pagecounts-20101223-030000.gz',
        'pagecounts-20101223-040000.gz',
        'pagecounts-20101223-050000.gz',
        'pagecounts-20101223-060000.gz',
        'pagecounts-20101223-070000.gz',
        'pagecounts-20101223-080000.gz',
        'pagecounts-20101223-090000.gz',
        'pagecounts-20101223-100000.gz',
        'pagecounts-20101223-110001.gz',
        'pagecounts-20101223-120000.gz',
        'pagecounts-20101223-130000.gz',
        'pagecounts-20101223-140000.gz',
        'pagecounts-20101223-150000.gz',
        'pagecounts-20101223-160000.gz',
        'pagecounts-20101223-170000.gz',
        'pagecounts-20101223-180000.gz',
        'pagecounts-20101223-190000.gz',
        'pagecounts-20101223-200000.gz',
        'pagecounts-20101223-210000.gz',
        'pagecounts-20101223-220000.gz',
        'pagecounts-20101223-230001.gz',
        'pagecounts-20101224-000000.gz',
        'pagecounts-20101224-010000.gz',
        'pagecounts-20101224-020000.gz',
        'pagecounts-20101224-030000.gz',
        'pagecounts-20101224-040000.gz',
        'pagecounts-20101224-050000.gz',
        'pagecounts-20101224-060000.gz',
        'pagecounts-20101224-070000.gz',
        'pagecounts-20101224-080000.gz',
        'pagecounts-20101224-090000.gz',
        'pagecounts-20101224-100000.gz',
        'pagecounts-20101224-110000.gz',
        'pagecounts-20101224-120000.gz',
        'pagecounts-20101224-130001.gz',
        'pagecounts-20101224-140000.gz',
        'pagecounts-20101224-150000.gz',
        'pagecounts-20101224-160000.gz',
        'pagecounts-20101224-170000.gz',
        'pagecounts-20101224-180000.gz',
        'pagecounts-20101224-190000.gz',
        'pagecounts-20101224-200000.gz',
        'pagecounts-20101224-210000.gz',
        'pagecounts-20101224-220000.gz',
        'pagecounts-20101224-230000.gz',
        'pagecounts-20101225-000000.gz',
        'pagecounts-20101225-010000.gz',
        'pagecounts-20101225-020000.gz',
        'pagecounts-20101225-030001.gz',
        'pagecounts-20101225-040000.gz',
        'pagecounts-20101225-050000.gz',
        'pagecounts-20101225-060000.gz',
        'pagecounts-20101225-070000.gz',
        'pagecounts-20101225-080000.gz',
        'pagecounts-20101225-090000.gz',
        'pagecounts-20101225-100000.gz',
        'pagecounts-20101225-110000.gz',
        'pagecounts-20101225-120000.gz',
        'pagecounts-20101225-130000.gz',
        'pagecounts-20101225-140000.gz',
        'pagecounts-20101225-150000.gz',
        'pagecounts-20101225-160001.gz',
        'pagecounts-20101225-170000.gz',
        'pagecounts-20101225-180000.gz',
        'pagecounts-20101225-190000.gz',
        'pagecounts-20101225-200000.gz',
        'pagecounts-20101225-210000.gz',
        'pagecounts-20101225-220000.gz',
        'pagecounts-20101225-230000.gz',
        'pagecounts-20101226-000000.gz',
        'pagecounts-20101226-010000.gz',
        'pagecounts-20101226-020000.gz',
        'pagecounts-20101226-030000.gz',
        'pagecounts-20101226-040000.gz',
        'pagecounts-20101226-050000.gz',
        'pagecounts-20101226-060001.gz',
        'pagecounts-20101226-070000.gz',
        'pagecounts-20101226-080000.gz',
        'pagecounts-20101226-090000.gz',
        'pagecounts-20101226-100000.gz',
        'pagecounts-20101226-110000.gz',
        'pagecounts-20101226-120000.gz',
        'pagecounts-20101226-130000.gz',
        'pagecounts-20101226-140000.gz',
        'pagecounts-20101226-150000.gz',
        'pagecounts-20101226-160000.gz',
        'pagecounts-20101226-170000.gz',
        'pagecounts-20101226-180000.gz',
        'pagecounts-20101226-190000.gz',
        'pagecounts-20101226-200001.gz',
        'pagecounts-20101226-210000.gz',
        'pagecounts-20101226-220000.gz',
        'pagecounts-20101226-230000.gz',
        'pagecounts-20101227-000000.gz',
        'pagecounts-20101227-010000.gz',
        'pagecounts-20101227-020000.gz',
        'pagecounts-20101227-030000.gz',
        'pagecounts-20101227-040000.gz',
        'pagecounts-20101227-050000.gz',
        'pagecounts-20101227-060000.gz',
        'pagecounts-20101227-070000.gz',
        'pagecounts-20101227-080000.gz',
        'pagecounts-20101227-090001.gz',
        'pagecounts-20101227-100000.gz',
        'pagecounts-20101227-110000.gz',
        'pagecounts-20101227-120000.gz',
        'pagecounts-20101227-130000.gz',
        'pagecounts-20101227-140000.gz',
        'pagecounts-20101227-150000.gz',
        'pagecounts-20101227-160000.gz',
        'pagecounts-20101227-170000.gz',
        'pagecounts-20101227-180000.gz',
        'pagecounts-20101227-190000.gz',
        'pagecounts-20101227-200000.gz',
        'pagecounts-20101227-210001.gz',
        'pagecounts-20101227-220000.gz',
        'pagecounts-20101227-230000.gz',
        'pagecounts-20101228-000000.gz',
        'pagecounts-20101228-010000.gz',
        'pagecounts-20101228-020000.gz',
        'pagecounts-20101228-030000.gz',
        'pagecounts-20101228-040000.gz',
        'pagecounts-20101228-050000.gz',
        'pagecounts-20101228-060000.gz',
        'pagecounts-20101228-070000.gz',
        'pagecounts-20101228-080000.gz',
        'pagecounts-20101228-090000.gz',
        'pagecounts-20101228-100000.gz',
        'pagecounts-20101228-110001.gz',
        'pagecounts-20101228-120000.gz',
        'pagecounts-20101228-130000.gz',
        'pagecounts-20101228-140000.gz',
        'pagecounts-20101228-150000.gz',
        'pagecounts-20101228-160000.gz',
        'pagecounts-20101228-170000.gz',
        'pagecounts-20101228-180000.gz',
        'pagecounts-20101228-190000.gz',
        'pagecounts-20101228-200000.gz',
        'pagecounts-20101228-210000.gz',
        'pagecounts-20101228-220001.gz',
        'pagecounts-20101228-230000.gz',
        'pagecounts-20101229-000000.gz',
        'pagecounts-20101229-010000.gz',
        'pagecounts-20101229-020000.gz',
        'pagecounts-20101229-030000.gz',
        'pagecounts-20101229-040000.gz',
        'pagecounts-20101229-050000.gz',
        'pagecounts-20101229-060000.gz',
        'pagecounts-20101229-070000.gz',
        'pagecounts-20101229-080000.gz',
        'pagecounts-20101229-090000.gz',
        'pagecounts-20101229-100000.gz',
        'pagecounts-20101229-110000.gz',
        'pagecounts-20101229-120001.gz',
        'pagecounts-20101229-130000.gz',
        'pagecounts-20101229-140000.gz',
        'pagecounts-20101229-150000.gz',
        'pagecounts-20101229-160000.gz',
        'pagecounts-20101229-170000.gz',
        'pagecounts-20101229-180000.gz',
        'pagecounts-20101229-190000.gz',
        'pagecounts-20101229-200000.gz',
        'pagecounts-20101229-210000.gz',
        'pagecounts-20101229-220000.gz',
        'pagecounts-20101229-230001.gz',
        'pagecounts-20101230-000000.gz',
        'pagecounts-20101230-010000.gz',
        'pagecounts-20101230-020000.gz',
        'pagecounts-20101230-030000.gz',
        'pagecounts-20101230-040000.gz',
        'pagecounts-20101230-050000.gz',
        'pagecounts-20101230-060000.gz',
        'pagecounts-20101230-070000.gz',
        'pagecounts-20101230-080000.gz',
        'pagecounts-20101230-090000.gz',
        'pagecounts-20101230-100000.gz',
        'pagecounts-20101230-110000.gz',
        'pagecounts-20101230-120000.gz',
        'pagecounts-20101230-130001.gz',
        'pagecounts-20101230-140000.gz',
        'pagecounts-20101230-150000.gz',
        'pagecounts-20101230-160000.gz',
        'pagecounts-20101230-170000.gz',
        'pagecounts-20101230-180000.gz',
        'pagecounts-20101230-190000.gz',
        'pagecounts-20101230-200000.gz',
        'pagecounts-20101230-210000.gz',
        'pagecounts-20101230-220000.gz',
        'pagecounts-20101230-230000.gz',
        'pagecounts-20101231-000000.gz',
        'pagecounts-20101231-010001.gz',
        'pagecounts-20101231-020000.gz',
        'pagecounts-20101231-030000.gz',
        'pagecounts-20101231-040000.gz',
        'pagecounts-20101231-050000.gz',
        'pagecounts-20101231-060000.gz',
        'pagecounts-20101231-070000.gz',
        'pagecounts-20101231-080000.gz',
        'pagecounts-20101231-090000.gz',
        'pagecounts-20101231-100000.gz',
        'pagecounts-20101231-110000.gz',
        'pagecounts-20101231-120000.gz',
        'pagecounts-20101231-130000.gz',
        'pagecounts-20101231-140000.gz',
        'pagecounts-20101231-150000.gz',
        'pagecounts-20101231-160001.gz',
        'pagecounts-20101231-170000.gz',
        'pagecounts-20101231-180000.gz',
        'pagecounts-20101231-190000.gz',
        'pagecounts-20101231-200000.gz',
        'pagecounts-20101231-210000.gz',
        'pagecounts-20101231-220000.gz',
        'pagecounts-20101231-230000.gz'
    ]

    # md5 checksum hashes to python
    dt_md5 = 'md5sums.txt'
    dt_pd_md5 = pd.read_table(os.path.dirname(os.path.realpath(__file__)) + sl + dt_md5, delim_whitespace=True,
                              header=None, names=['md5', 'fname'], index_col=1)

    dt_pd_wiki_legacy = pd.DataFrame(columns=['project', 'page_title', 'counter', 'rsize', 'tstamp'])
    # dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])
    dt_pd_wiki_legacy.set_index('page_title', inplace=True, drop=True, append=False, verify_integrity=True)

    t = 0
    for x in files:
        if hashlib.md5(open(x, 'rb').read()).hexdigest() == dt_pd_md5.loc[x]['md5']:
            print('md5 match', x)
            try:
                f = gzip.open(x, 'rb')
                file_content = f.read()
                f.close()
                winp = io.StringIO(file_content.decode('utf-8', errors='replace'))
                wframe = pd.read_table(winp, sep=' ', usecols=[0, 1, 2, 3],
                                       names=['project', 'page_title', 'counter', 'rsize'], index_col=['page_title'])
                # f.close()
                try:
                    wframe = wframe.loc['Bitcoin']
                    # wframe['tstamp'] = pd.to_datetime(dt.datetime.strptime(x[11:-3], "%Y%m%d-%H%M%S"))
                    wframe['tstamp'] = x[11:-3]
                    dt_pd_wiki_legacy = dt_pd_wiki_legacy.append(wframe)
                    dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])
                    print('----------------------------')
                    print(t)
                    print('progres: ', round((t / len(files))*100, 1), "%")
                    dt_pd_wiki_legacy.to_pickle('dt_pd_wiki_legacy.pickle')
                    t = t + 1
                except Exception:
                    print('error in (no bitcoin article retrives): ',x)
            except Exception:
                print('gzip open error in ', x)
        else:
            print('------------------------------------------------------')
            print('MD5 error in file', x)
            print('------------------------------------------------------')

    # dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])

    print('current cycle of scraping done')

if __name__ == '__main__':
    main()
else:
    print("Run From Import")