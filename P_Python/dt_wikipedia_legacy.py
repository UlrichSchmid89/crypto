# https://pypi.python.org/pypi/mwviews
# https://github.com/Commonists/pageview-api
# https://wikimedia.org/api/rest_v1/#!/Pageviews_data/get_metrics_pageviews_per_article_project_access_agent_article_granularity_start_end
# actual (not legacy) https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/bitcoin/daily/2010071800/20181124

# https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/bitcoin/daily/2010071800/20181124
# https://wikitech.wikimedia.org/wiki/Analytics/Pageviews
# https://wikitech.wikimedia.org/wiki/Analytics/Systems/Dashiki
# https://github.com/abelsson/stats.grok.se/blob/master/backend/getstats.py
# https://dumps.wikimedia.org/other/pagecounts-raw/
# https://dumps.wikimedia.org/other/pagecounts-ez/

import gzip
import os
# from tkinter import Tk
import scipy
import datetime as dt
print('scipy: %s' % scipy.__version__)
import numpy as np
print('numpy: %s' % np.__version__)
import pandas as pd
import hashlib
print('pandas: %s' % pd.__version__)

print(os.getcwd())

def main():
    print("First Module's Name: {}".format(__name__))

    if os.name == 'posix':
        sl = '/'
    elif os.name == 'nt':
        sl = '\\'

    # All Files to be read in current cycle of scraping
    files = [
        'pagecounts-20100801-000000.gz',
        'pagecounts-20100801-010000.gz',
        'pagecounts-20100801-020000.gz',
        'pagecounts-20100801-030000.gz',
        'pagecounts-20100801-040000.gz',
        'pagecounts-20100801-050000.gz',
        'pagecounts-20100801-060000.gz',
        'pagecounts-20100801-070001.gz',
        'pagecounts-20100801-080000.gz',
        'pagecounts-20100801-090000.gz',
        'pagecounts-20100801-100000.gz',
        'pagecounts-20100801-110000.gz',
        'pagecounts-20100801-120000.gz',
        'pagecounts-20100801-130000.gz',
        'pagecounts-20100801-140000.gz',
        'pagecounts-20100801-150000.gz',
        'pagecounts-20100801-160000.gz',
        'pagecounts-20100801-170000.gz',
        'pagecounts-20100801-180000.gz',
        'pagecounts-20100801-190000.gz',
        'pagecounts-20100801-200000.gz',
        'pagecounts-20100801-210001.gz',
        'pagecounts-20100801-220000.gz',
        'pagecounts-20100801-230000.gz',
        'pagecounts-20100802-000000.gz',
        'pagecounts-20100802-010000.gz',
        'pagecounts-20100802-020000.gz',
        'pagecounts-20100802-030000.gz',
        'pagecounts-20100802-040000.gz',
        'pagecounts-20100802-050000.gz',
        'pagecounts-20100802-060000.gz',
        'pagecounts-20100802-070000.gz',
        'pagecounts-20100802-080000.gz',
        'pagecounts-20100802-090000.gz',
        'pagecounts-20100802-100001.gz',
        'pagecounts-20100802-110000.gz',
        'pagecounts-20100802-120000.gz',
        'pagecounts-20100802-130000.gz',
        'pagecounts-20100802-140000.gz',
        'pagecounts-20100802-150000.gz',
        'pagecounts-20100802-160000.gz',
        'pagecounts-20100802-170000.gz',
        'pagecounts-20100802-180000.gz',
        'pagecounts-20100802-190000.gz',
        'pagecounts-20100802-200000.gz',
        'pagecounts-20100802-210000.gz',
        'pagecounts-20100802-220001.gz',
        'pagecounts-20100802-230000.gz',
        'pagecounts-20100803-000000.gz',
        'pagecounts-20100803-010000.gz',
        'pagecounts-20100803-020000.gz',
        'pagecounts-20100803-030000.gz',
        'pagecounts-20100803-040000.gz',
        'pagecounts-20100803-050000.gz',
        'pagecounts-20100803-060000.gz',
        'pagecounts-20100803-070000.gz',
        'pagecounts-20100803-080000.gz',
        'pagecounts-20100803-090000.gz',
        'pagecounts-20100803-100000.gz',
        'pagecounts-20100803-110000.gz',
        'pagecounts-20100803-120001.gz',
        'pagecounts-20100803-130000.gz',
        'pagecounts-20100803-140000.gz',
        'pagecounts-20100803-150000.gz',
        'pagecounts-20100803-160000.gz',
        'pagecounts-20100803-170000.gz',
        'pagecounts-20100803-180000.gz',
        'pagecounts-20100803-190000.gz',
        'pagecounts-20100803-200000.gz',
        'pagecounts-20100803-210000.gz',
        'pagecounts-20100803-220000.gz',
        'pagecounts-20100803-230000.gz',
        'pagecounts-20100804-000001.gz',
        'pagecounts-20100804-010000.gz',
        'pagecounts-20100804-020000.gz',
        'pagecounts-20100804-030000.gz',
        'pagecounts-20100804-040000.gz',
        'pagecounts-20100804-050000.gz',
        'pagecounts-20100804-060000.gz',
        'pagecounts-20100804-070000.gz',
        'pagecounts-20100804-080000.gz',
        'pagecounts-20100804-090000.gz',
        'pagecounts-20100804-100000.gz',
        'pagecounts-20100804-110000.gz',
        'pagecounts-20100804-120000.gz',
        'pagecounts-20100804-130000.gz',
        'pagecounts-20100804-140001.gz',
        'pagecounts-20100804-150000.gz',
        'pagecounts-20100804-160000.gz',
        'pagecounts-20100804-170000.gz',
        'pagecounts-20100804-180000.gz',
        'pagecounts-20100804-190000.gz',
        'pagecounts-20100804-200000.gz',
        'pagecounts-20100804-210000.gz',
        'pagecounts-20100804-220000.gz',
        'pagecounts-20100804-230000.gz',
        'pagecounts-20100805-000000.gz',
        'pagecounts-20100805-010001.gz',
        'pagecounts-20100805-020000.gz',
        'pagecounts-20100805-030000.gz',
        'pagecounts-20100805-040000.gz',
        'pagecounts-20100805-050000.gz',
        'pagecounts-20100805-060000.gz',
        'pagecounts-20100805-070000.gz',
        'pagecounts-20100805-080000.gz',
        'pagecounts-20100805-090000.gz',
        'pagecounts-20100805-100000.gz',
        'pagecounts-20100805-110000.gz',
        'pagecounts-20100805-120000.gz',
        'pagecounts-20100805-130000.gz',
        'pagecounts-20100805-140000.gz',
        'pagecounts-20100805-150001.gz',
        'pagecounts-20100805-160000.gz',
        'pagecounts-20100805-170000.gz',
        'pagecounts-20100805-180000.gz',
        'pagecounts-20100805-190000.gz',
        'pagecounts-20100805-200000.gz',
        'pagecounts-20100805-210000.gz',
        'pagecounts-20100805-220000.gz',
        'pagecounts-20100805-230000.gz',
        'pagecounts-20100806-000000.gz',
        'pagecounts-20100806-010000.gz',
        'pagecounts-20100806-020000.gz',
        'pagecounts-20100806-030000.gz',
        'pagecounts-20100806-040001.gz',
        'pagecounts-20100806-050000.gz',
        'pagecounts-20100806-060000.gz',
        'pagecounts-20100806-070000.gz',
        'pagecounts-20100806-080000.gz',
        'pagecounts-20100806-090000.gz',
        'pagecounts-20100806-100000.gz',
        'pagecounts-20100806-110000.gz',
        'pagecounts-20100806-120000.gz',
        'pagecounts-20100806-130000.gz',
        'pagecounts-20100806-140000.gz',
        'pagecounts-20100806-150000.gz',
        'pagecounts-20100806-160000.gz',
        'pagecounts-20100806-170001.gz',
        'pagecounts-20100806-180000.gz',
        'pagecounts-20100806-190000.gz',
        'pagecounts-20100806-200000.gz',
        'pagecounts-20100806-210000.gz',
        'pagecounts-20100806-220000.gz',
        'pagecounts-20100806-230000.gz',
        'pagecounts-20100807-000000.gz',
        'pagecounts-20100807-010000.gz',
        'pagecounts-20100807-020000.gz',
        'pagecounts-20100807-030000.gz',
        'pagecounts-20100807-040000.gz',
        'pagecounts-20100807-050000.gz',
        'pagecounts-20100807-060000.gz',
        'pagecounts-20100807-070000.gz',
        'pagecounts-20100807-080001.gz',
        'pagecounts-20100807-090000.gz',
        'pagecounts-20100807-100000.gz',
        'pagecounts-20100807-110000.gz',
        'pagecounts-20100807-120000.gz',
        'pagecounts-20100807-130000.gz',
        'pagecounts-20100807-140000.gz',
        'pagecounts-20100807-150000.gz',
        'pagecounts-20100807-160000.gz',
        'pagecounts-20100807-170000.gz',
        'pagecounts-20100807-180000.gz',
        'pagecounts-20100807-190000.gz',
        'pagecounts-20100807-200001.gz',
        'pagecounts-20100807-210000.gz',
        'pagecounts-20100807-220000.gz',
        'pagecounts-20100807-230000.gz',
        'pagecounts-20100808-000000.gz',
        'pagecounts-20100808-010000.gz',
        'pagecounts-20100808-020000.gz',
        'pagecounts-20100808-030000.gz',
        'pagecounts-20100808-040000.gz',
        'pagecounts-20100808-050000.gz',
        'pagecounts-20100808-060000.gz',
        'pagecounts-20100808-070000.gz',
        'pagecounts-20100808-080000.gz',
        'pagecounts-20100808-090000.gz',
        'pagecounts-20100808-100000.gz',
        'pagecounts-20100808-110001.gz',
        'pagecounts-20100808-120000.gz',
        'pagecounts-20100808-130000.gz',
        'pagecounts-20100808-140000.gz',
        'pagecounts-20100808-150000.gz',
        'pagecounts-20100808-160000.gz',
        'pagecounts-20100808-170000.gz',
        'pagecounts-20100808-180000.gz',
        'pagecounts-20100808-190000.gz',
        'pagecounts-20100808-200000.gz',
        'pagecounts-20100808-210000.gz',
        'pagecounts-20100808-220000.gz',
        'pagecounts-20100808-230000.gz',
        'pagecounts-20100809-000001.gz',
        'pagecounts-20100809-010000.gz',
        'pagecounts-20100809-020000.gz',
        'pagecounts-20100809-030000.gz',
        'pagecounts-20100809-040000.gz',
        'pagecounts-20100809-050000.gz',
        'pagecounts-20100809-060000.gz',
        'pagecounts-20100809-070000.gz',
        'pagecounts-20100809-080000.gz',
        'pagecounts-20100809-090000.gz',
        'pagecounts-20100809-100000.gz',
        'pagecounts-20100809-110000.gz',
        'pagecounts-20100809-120000.gz',
        'pagecounts-20100809-130000.gz',
        'pagecounts-20100809-140001.gz',
        'pagecounts-20100809-150000.gz',
        'pagecounts-20100809-160000.gz',
        'pagecounts-20100809-170000.gz',
        'pagecounts-20100809-180000.gz',
        'pagecounts-20100809-190000.gz',
        'pagecounts-20100809-200000.gz',
        'pagecounts-20100809-210000.gz',
        'pagecounts-20100809-220000.gz',
        'pagecounts-20100809-230000.gz',
        'pagecounts-20100810-000000.gz',
        'pagecounts-20100810-010000.gz',
        'pagecounts-20100810-020000.gz',
        'pagecounts-20100810-030001.gz',
        'pagecounts-20100810-040000.gz',
        'pagecounts-20100810-050000.gz',
        'pagecounts-20100810-060000.gz',
        'pagecounts-20100810-070000.gz',
        'pagecounts-20100810-080000.gz',
        'pagecounts-20100810-090000.gz',
        'pagecounts-20100810-100000.gz',
        'pagecounts-20100810-110000.gz',
        'pagecounts-20100810-120000.gz',
        'pagecounts-20100810-130000.gz',
        'pagecounts-20100810-140000.gz',
        'pagecounts-20100810-150000.gz',
        'pagecounts-20100810-160001.gz',
        'pagecounts-20100810-170000.gz',
        'pagecounts-20100810-180000.gz',
        'pagecounts-20100810-190000.gz',
        'pagecounts-20100810-200000.gz',
        'pagecounts-20100810-210000.gz',
        'pagecounts-20100810-220000.gz',
        'pagecounts-20100810-230000.gz',
        'pagecounts-20100811-000000.gz',
        'pagecounts-20100811-010000.gz',
        'pagecounts-20100811-020000.gz',
        'pagecounts-20100811-030000.gz',
        'pagecounts-20100811-040000.gz',
        'pagecounts-20100811-050000.gz',
        'pagecounts-20100811-060001.gz',
        'pagecounts-20100811-070000.gz',
        'pagecounts-20100811-080000.gz',
        'pagecounts-20100811-090000.gz',
        'pagecounts-20100811-100000.gz',
        'pagecounts-20100811-110000.gz',
        'pagecounts-20100811-120000.gz',
        'pagecounts-20100811-130000.gz',
        'pagecounts-20100811-140000.gz',
        'pagecounts-20100811-150000.gz',
        'pagecounts-20100811-160000.gz',
        'pagecounts-20100811-170000.gz',
        'pagecounts-20100811-180000.gz',
        'pagecounts-20100811-190001.gz',
        'pagecounts-20100811-200000.gz',
        'pagecounts-20100811-210000.gz',
        'pagecounts-20100811-220000.gz',
        'pagecounts-20100811-230000.gz',
        'pagecounts-20100812-000000.gz',
        'pagecounts-20100812-010000.gz',
        'pagecounts-20100812-020000.gz',
        'pagecounts-20100812-030000.gz',
        'pagecounts-20100812-040000.gz',
        'pagecounts-20100812-050000.gz',
        'pagecounts-20100812-060000.gz',
        'pagecounts-20100812-070000.gz',
        'pagecounts-20100812-080000.gz',
        'pagecounts-20100812-090001.gz',
        'pagecounts-20100812-100000.gz',
        'pagecounts-20100812-110000.gz',
        'pagecounts-20100812-120000.gz',
        'pagecounts-20100812-130000.gz',
        'pagecounts-20100812-140000.gz',
        'pagecounts-20100812-150000.gz',
        'pagecounts-20100812-160000.gz',
        'pagecounts-20100812-170000.gz',
        'pagecounts-20100812-180000.gz',
        'pagecounts-20100812-190000.gz',
        'pagecounts-20100812-200000.gz',
        'pagecounts-20100812-210000.gz',
        'pagecounts-20100812-220001.gz',
        'pagecounts-20100812-230000.gz',
        'pagecounts-20100813-000000.gz',
        'pagecounts-20100813-010000.gz',
        'pagecounts-20100813-020000.gz',
        'pagecounts-20100813-030000.gz',
        'pagecounts-20100813-040000.gz',
        'pagecounts-20100813-050000.gz',
        'pagecounts-20100813-060000.gz',
        'pagecounts-20100813-070000.gz',
        'pagecounts-20100813-080000.gz',
        'pagecounts-20100813-090000.gz',
        'pagecounts-20100813-100000.gz',
        'pagecounts-20100813-110000.gz',
        'pagecounts-20100813-120000.gz',
        'pagecounts-20100813-130001.gz',
        'pagecounts-20100813-140000.gz',
        'pagecounts-20100813-150000.gz',
        'pagecounts-20100813-160000.gz',
        'pagecounts-20100813-170000.gz',
        'pagecounts-20100813-180000.gz',
        'pagecounts-20100813-190000.gz',
        'pagecounts-20100813-200000.gz',
        'pagecounts-20100813-210000.gz',
        'pagecounts-20100813-220000.gz',
        'pagecounts-20100813-230000.gz',
        'pagecounts-20100814-000000.gz',
        'pagecounts-20100814-010000.gz',
        'pagecounts-20100814-020000.gz',
        'pagecounts-20100814-030001.gz',
        'pagecounts-20100814-040000.gz',
        'pagecounts-20100814-050000.gz',
        'pagecounts-20100814-060000.gz',
        'pagecounts-20100814-070000.gz',
        'pagecounts-20100814-080000.gz',
        'pagecounts-20100814-090000.gz',
        'pagecounts-20100814-100000.gz',
        'pagecounts-20100814-110000.gz',
        'pagecounts-20100814-120000.gz',
        'pagecounts-20100814-130000.gz',
        'pagecounts-20100814-140000.gz',
        'pagecounts-20100814-150000.gz',
        'pagecounts-20100814-160000.gz',
        'pagecounts-20100814-170000.gz',
        'pagecounts-20100814-180001.gz',
        'pagecounts-20100814-190000.gz',
        'pagecounts-20100814-200000.gz',
        'pagecounts-20100814-210000.gz',
        'pagecounts-20100814-220000.gz',
        'pagecounts-20100814-230000.gz',
        'pagecounts-20100815-000000.gz',
        'pagecounts-20100815-010000.gz',
        'pagecounts-20100815-020000.gz',
        'pagecounts-20100815-030000.gz',
        'pagecounts-20100815-040000.gz',
        'pagecounts-20100815-050000.gz',
        'pagecounts-20100815-060000.gz',
        'pagecounts-20100815-070000.gz',
        'pagecounts-20100815-080001.gz',
        'pagecounts-20100815-090000.gz',
        'pagecounts-20100815-100000.gz',
        'pagecounts-20100815-110000.gz',
        'pagecounts-20100815-120000.gz',
        'pagecounts-20100815-130000.gz',
        'pagecounts-20100815-140000.gz',
        'pagecounts-20100815-150000.gz',
        'pagecounts-20100815-160000.gz',
        'pagecounts-20100815-170000.gz',
        'pagecounts-20100815-180000.gz',
        'pagecounts-20100815-190000.gz',
        'pagecounts-20100815-200000.gz',
        'pagecounts-20100815-210001.gz',
        'pagecounts-20100815-220000.gz',
        'pagecounts-20100815-230000.gz',
        'pagecounts-20100816-000000.gz',
        'pagecounts-20100816-010000.gz',
        'pagecounts-20100816-020000.gz',
        'pagecounts-20100816-030000.gz',
        'pagecounts-20100816-040000.gz',
        'pagecounts-20100816-050000.gz',
        'pagecounts-20100816-060000.gz',
        'pagecounts-20100816-070000.gz',
        'pagecounts-20100816-080000.gz',
        'pagecounts-20100816-090000.gz',
        'pagecounts-20100816-100000.gz',
        'pagecounts-20100816-110001.gz',
        'pagecounts-20100816-120000.gz',
        'pagecounts-20100816-130000.gz',
        'pagecounts-20100816-140000.gz',
        'pagecounts-20100816-150000.gz',
        'pagecounts-20100816-160000.gz',
        'pagecounts-20100816-170000.gz',
        'pagecounts-20100816-180000.gz',
        'pagecounts-20100816-190000.gz',
        'pagecounts-20100816-200000.gz',
        'pagecounts-20100816-210000.gz',
        'pagecounts-20100816-220000.gz',
        'pagecounts-20100816-230001.gz',
        'pagecounts-20100817-000000.gz',
        'pagecounts-20100817-010000.gz',
        'pagecounts-20100817-020000.gz',
        'pagecounts-20100817-030000.gz',
        'pagecounts-20100817-040000.gz',
        'pagecounts-20100817-050000.gz',
        'pagecounts-20100817-060000.gz',
        'pagecounts-20100817-070000.gz',
        'pagecounts-20100817-080000.gz',
        'pagecounts-20100817-090000.gz',
        'pagecounts-20100817-100000.gz',
        'pagecounts-20100817-110000.gz',
        'pagecounts-20100817-120000.gz',
        'pagecounts-20100817-130000.gz',
        'pagecounts-20100817-140001.gz',
        'pagecounts-20100817-150000.gz',
        'pagecounts-20100817-160000.gz',
        'pagecounts-20100817-170000.gz',
        'pagecounts-20100817-180000.gz',
        'pagecounts-20100817-190000.gz',
        'pagecounts-20100817-200000.gz',
        'pagecounts-20100817-210000.gz',
        'pagecounts-20100817-220000.gz',
        'pagecounts-20100817-230000.gz',
        'pagecounts-20100818-000000.gz',
        'pagecounts-20100818-010000.gz',
        'pagecounts-20100818-020000.gz',
        'pagecounts-20100818-030000.gz',
        'pagecounts-20100818-040001.gz',
        'pagecounts-20100818-050000.gz',
        'pagecounts-20100818-060000.gz',
        'pagecounts-20100818-070000.gz',
        'pagecounts-20100818-080000.gz',
        'pagecounts-20100818-090000.gz',
        'pagecounts-20100818-100000.gz',
        'pagecounts-20100818-110000.gz',
        'pagecounts-20100818-120000.gz',
        'pagecounts-20100818-130000.gz',
        'pagecounts-20100818-140000.gz',
        'pagecounts-20100818-150000.gz',
        'pagecounts-20100818-160000.gz',
        'pagecounts-20100818-170001.gz',
        'pagecounts-20100818-180000.gz',
        'pagecounts-20100818-190000.gz',
        'pagecounts-20100818-200000.gz',
        'pagecounts-20100818-210000.gz',
        'pagecounts-20100818-220000.gz',
        'pagecounts-20100818-230000.gz',
        'pagecounts-20100819-000000.gz',
        'pagecounts-20100819-010000.gz',
        'pagecounts-20100819-020000.gz',
        'pagecounts-20100819-030000.gz',
        'pagecounts-20100819-040000.gz',
        'pagecounts-20100819-050000.gz',
        'pagecounts-20100819-060000.gz',
        'pagecounts-20100819-070001.gz',
        'pagecounts-20100819-080000.gz',
        'pagecounts-20100819-090000.gz',
        'pagecounts-20100819-100000.gz',
        'pagecounts-20100819-110000.gz',
        'pagecounts-20100819-120000.gz',
        'pagecounts-20100819-130000.gz',
        'pagecounts-20100819-140000.gz',
        'pagecounts-20100819-150000.gz',
        'pagecounts-20100819-160000.gz',
        'pagecounts-20100819-170000.gz',
        'pagecounts-20100819-180000.gz',
        'pagecounts-20100819-190000.gz',
        'pagecounts-20100819-200001.gz',
        'pagecounts-20100819-210000.gz',
        'pagecounts-20100819-220000.gz',
        'pagecounts-20100819-230000.gz',
        'pagecounts-20100820-000000.gz',
        'pagecounts-20100820-010000.gz',
        'pagecounts-20100820-020000.gz',
        'pagecounts-20100820-030000.gz',
        'pagecounts-20100820-040000.gz',
        'pagecounts-20100820-050000.gz',
        'pagecounts-20100820-060000.gz',
        'pagecounts-20100820-070000.gz',
        'pagecounts-20100820-080000.gz',
        'pagecounts-20100820-090000.gz',
        'pagecounts-20100820-100001.gz',
        'pagecounts-20100820-110000.gz',
        'pagecounts-20100820-120000.gz',
        'pagecounts-20100820-130000.gz',
        'pagecounts-20100820-140000.gz',
        'pagecounts-20100820-150000.gz',
        'pagecounts-20100820-160000.gz',
        'pagecounts-20100820-170000.gz',
        'pagecounts-20100820-180000.gz',
        'pagecounts-20100820-190000.gz',
        'pagecounts-20100820-200000.gz',
        'pagecounts-20100820-210000.gz',
        'pagecounts-20100820-220000.gz',
        'pagecounts-20100820-230000.gz',
        'pagecounts-20100821-000001.gz',
        'pagecounts-20100821-010000.gz',
        'pagecounts-20100821-020000.gz',
        'pagecounts-20100821-030000.gz',
        'pagecounts-20100821-040000.gz',
        'pagecounts-20100821-050000.gz',
        'pagecounts-20100821-060000.gz',
        'pagecounts-20100821-070000.gz',
        'pagecounts-20100821-080000.gz',
        'pagecounts-20100821-090000.gz',
        'pagecounts-20100821-100000.gz',
        'pagecounts-20100821-110000.gz',
        'pagecounts-20100821-120000.gz',
        'pagecounts-20100821-130000.gz',
        'pagecounts-20100821-140000.gz',
        'pagecounts-20100821-150001.gz',
        'pagecounts-20100821-160000.gz',
        'pagecounts-20100821-170000.gz',
        'pagecounts-20100821-180000.gz',
        'pagecounts-20100821-190000.gz',
        'pagecounts-20100821-200000.gz',
        'pagecounts-20100821-210000.gz',
        'pagecounts-20100821-220000.gz',
        'pagecounts-20100821-230000.gz',
        'pagecounts-20100822-000000.gz',
        'pagecounts-20100822-010000.gz',
        'pagecounts-20100822-020000.gz',
        'pagecounts-20100822-030000.gz',
        'pagecounts-20100822-040000.gz',
        'pagecounts-20100822-050001.gz',
        'pagecounts-20100822-060000.gz',
        'pagecounts-20100822-070000.gz',
        'pagecounts-20100822-080000.gz',
        'pagecounts-20100822-090000.gz',
        'pagecounts-20100822-100000.gz',
        'pagecounts-20100822-110000.gz',
        'pagecounts-20100822-120000.gz',
        'pagecounts-20100822-130000.gz',
        'pagecounts-20100822-140000.gz',
        'pagecounts-20100822-150000.gz',
        'pagecounts-20100822-160000.gz',
        'pagecounts-20100822-170000.gz',
        'pagecounts-20100822-180001.gz',
        'pagecounts-20100822-190000.gz',
        'pagecounts-20100822-200000.gz',
        'pagecounts-20100822-210000.gz',
        'pagecounts-20100822-220000.gz',
        'pagecounts-20100822-230000.gz',
        'pagecounts-20100823-000000.gz',
        'pagecounts-20100823-010000.gz',
        'pagecounts-20100823-020000.gz',
        'pagecounts-20100823-030000.gz',
        'pagecounts-20100823-040000.gz',
        'pagecounts-20100823-050000.gz',
        'pagecounts-20100823-060001.gz',
        'pagecounts-20100823-070000.gz',
        'pagecounts-20100823-080000.gz',
        'pagecounts-20100823-090000.gz',
        'pagecounts-20100823-100000.gz',
        'pagecounts-20100823-110000.gz',
        'pagecounts-20100823-120000.gz',
        'pagecounts-20100823-130000.gz',
        'pagecounts-20100823-140000.gz',
        'pagecounts-20100823-150000.gz',
        'pagecounts-20100823-160000.gz',
        'pagecounts-20100823-170000.gz',
        'pagecounts-20100823-180001.gz',
        'pagecounts-20100823-190000.gz',
        'pagecounts-20100823-200000.gz',
        'pagecounts-20100823-210000.gz',
        'pagecounts-20100823-220000.gz',
        'pagecounts-20100823-230000.gz',
        'pagecounts-20100824-000000.gz',
        'pagecounts-20100824-010000.gz',
        'pagecounts-20100824-020000.gz',
        'pagecounts-20100824-030000.gz',
        'pagecounts-20100824-040000.gz',
        'pagecounts-20100824-050000.gz',
        'pagecounts-20100824-060000.gz',
        'pagecounts-20100824-070001.gz',
        'pagecounts-20100824-080000.gz',
        'pagecounts-20100824-090000.gz',
        'pagecounts-20100824-100000.gz',
        'pagecounts-20100824-110000.gz',
        'pagecounts-20100824-120000.gz',
        'pagecounts-20100824-130000.gz',
        'pagecounts-20100824-140000.gz',
        'pagecounts-20100824-150000.gz',
        'pagecounts-20100824-160000.gz',
        'pagecounts-20100824-170000.gz',
        'pagecounts-20100824-180001.gz',
        'pagecounts-20100824-190000.gz',
        'pagecounts-20100824-200000.gz',
        'pagecounts-20100824-210000.gz',
        'pagecounts-20100824-220000.gz',
        'pagecounts-20100824-230000.gz',
        'pagecounts-20100825-000000.gz',
        'pagecounts-20100825-010000.gz',
        'pagecounts-20100825-020000.gz',
        'pagecounts-20100825-030000.gz',
        'pagecounts-20100825-040000.gz',
        'pagecounts-20100825-050000.gz',
        'pagecounts-20100825-060001.gz',
        'pagecounts-20100825-070000.gz',
        'pagecounts-20100825-080000.gz',
        'pagecounts-20100825-090000.gz',
        'pagecounts-20100825-100000.gz',
        'pagecounts-20100825-110000.gz',
        'pagecounts-20100825-120000.gz',
        'pagecounts-20100825-130000.gz',
        'pagecounts-20100825-140000.gz',
        'pagecounts-20100825-150000.gz',
        'pagecounts-20100825-160000.gz',
        'pagecounts-20100825-170000.gz',
        'pagecounts-20100825-180001.gz',
        'pagecounts-20100825-190000.gz',
        'pagecounts-20100825-200000.gz',
        'pagecounts-20100825-210000.gz',
        'pagecounts-20100825-220000.gz',
        'pagecounts-20100825-230000.gz',
        'pagecounts-20100826-000000.gz',
        'pagecounts-20100826-010000.gz',
        'pagecounts-20100826-020000.gz',
        'pagecounts-20100826-030000.gz',
        'pagecounts-20100826-040000.gz',
        'pagecounts-20100826-050000.gz',
        'pagecounts-20100826-060001.gz',
        'pagecounts-20100826-070000.gz',
        'pagecounts-20100826-080000.gz',
        'pagecounts-20100826-090000.gz',
        'pagecounts-20100826-100000.gz',
        'pagecounts-20100826-110000.gz',
        'pagecounts-20100826-120000.gz',
        'pagecounts-20100826-130000.gz',
        'pagecounts-20100826-140000.gz',
        'pagecounts-20100826-150000.gz',
        'pagecounts-20100826-160000.gz',
        'pagecounts-20100826-170000.gz',
        'pagecounts-20100826-180001.gz',
        'pagecounts-20100826-190000.gz',
        'pagecounts-20100826-200000.gz',
        'pagecounts-20100826-210000.gz',
        'pagecounts-20100826-220000.gz',
        'pagecounts-20100826-230000.gz',
        'pagecounts-20100827-000000.gz',
        'pagecounts-20100827-010000.gz',
        'pagecounts-20100827-020000.gz',
        'pagecounts-20100827-030000.gz',
        'pagecounts-20100827-040000.gz',
        'pagecounts-20100827-050000.gz',
        'pagecounts-20100827-060000.gz',
        'pagecounts-20100827-070001.gz',
        'pagecounts-20100827-080000.gz',
        'pagecounts-20100827-090000.gz',
        'pagecounts-20100827-100000.gz',
        'pagecounts-20100827-110000.gz',
        'pagecounts-20100827-120000.gz',
        'pagecounts-20100827-130000.gz',
        'pagecounts-20100827-140000.gz',
        'pagecounts-20100827-150000.gz',
        'pagecounts-20100827-160000.gz',
        'pagecounts-20100827-170000.gz',
        'pagecounts-20100827-180000.gz',
        'pagecounts-20100827-190001.gz',
        'pagecounts-20100827-200000.gz',
        'pagecounts-20100827-210000.gz',
        'pagecounts-20100827-220000.gz',
        'pagecounts-20100827-230000.gz',
        'pagecounts-20100828-000000.gz',
        'pagecounts-20100828-010000.gz',
        'pagecounts-20100828-020000.gz',
        'pagecounts-20100828-030000.gz',
        'pagecounts-20100828-040000.gz',
        'pagecounts-20100828-050000.gz',
        'pagecounts-20100828-060000.gz',
        'pagecounts-20100828-070000.gz',
        'pagecounts-20100828-080000.gz',
        'pagecounts-20100828-090001.gz',
        'pagecounts-20100828-100000.gz',
        'pagecounts-20100828-110000.gz',
        'pagecounts-20100828-120000.gz',
        'pagecounts-20100828-130000.gz',
        'pagecounts-20100828-140000.gz',
        'pagecounts-20100828-150000.gz',
        'pagecounts-20100828-160000.gz',
        'pagecounts-20100828-170000.gz',
        'pagecounts-20100828-180000.gz',
        'pagecounts-20100828-190000.gz',
        'pagecounts-20100828-200000.gz',
        'pagecounts-20100828-210000.gz',
        'pagecounts-20100828-220001.gz',
        'pagecounts-20100828-230000.gz',
        'pagecounts-20100829-000000.gz',
        'pagecounts-20100829-010000.gz',
        'pagecounts-20100829-020000.gz',
        'pagecounts-20100829-030000.gz',
        'pagecounts-20100829-040000.gz',
        'pagecounts-20100829-050000.gz',
        'pagecounts-20100829-060000.gz',
        'pagecounts-20100829-070000.gz',
        'pagecounts-20100829-080000.gz',
        'pagecounts-20100829-090000.gz',
        'pagecounts-20100829-100000.gz',
        'pagecounts-20100829-110000.gz',
        'pagecounts-20100829-120001.gz',
        'pagecounts-20100829-130000.gz',
        'pagecounts-20100829-140000.gz',
        'pagecounts-20100829-150000.gz',
        'pagecounts-20100829-160000.gz',
        'pagecounts-20100829-170000.gz',
        'pagecounts-20100829-180000.gz',
        'pagecounts-20100829-190000.gz',
        'pagecounts-20100829-200000.gz',
        'pagecounts-20100829-210000.gz',
        'pagecounts-20100829-220000.gz',
        'pagecounts-20100829-230000.gz',
        'pagecounts-20100830-000001.gz',
        'pagecounts-20100830-010000.gz',
        'pagecounts-20100830-020000.gz',
        'pagecounts-20100830-030000.gz',
        'pagecounts-20100830-040000.gz',
        'pagecounts-20100830-050000.gz',
        'pagecounts-20100830-060000.gz',
        'pagecounts-20100830-070000.gz',
        'pagecounts-20100830-080000.gz',
        'pagecounts-20100830-090000.gz',
        'pagecounts-20100830-100000.gz',
        'pagecounts-20100830-110000.gz',
        'pagecounts-20100830-120000.gz',
        'pagecounts-20100830-130000.gz',
        'pagecounts-20100830-140001.gz',
        'pagecounts-20100830-150000.gz',
        'pagecounts-20100830-160000.gz',
        'pagecounts-20100830-170000.gz',
        'pagecounts-20100830-180000.gz',
        'pagecounts-20100830-190000.gz',
        'pagecounts-20100830-200000.gz',
        'pagecounts-20100830-210000.gz',
        'pagecounts-20100830-220000.gz',
        'pagecounts-20100830-230000.gz',
        'pagecounts-20100831-000000.gz',
        'pagecounts-20100831-010000.gz',
        'pagecounts-20100831-020001.gz',
        'pagecounts-20100831-030000.gz',
        'pagecounts-20100831-040000.gz',
        'pagecounts-20100831-050000.gz',
        'pagecounts-20100831-060000.gz',
        'pagecounts-20100831-070000.gz',
        'pagecounts-20100831-080000.gz',
        'pagecounts-20100831-090000.gz',
        'pagecounts-20100831-100000.gz',
        'pagecounts-20100831-110000.gz',
        'pagecounts-20100831-120000.gz',
        'pagecounts-20100831-130000.gz',
        'pagecounts-20100831-140000.gz',
        'pagecounts-20100831-150001.gz',
        'pagecounts-20100831-160000.gz',
        'pagecounts-20100831-170000.gz',
        'pagecounts-20100831-180000.gz',
        'pagecounts-20100831-190000.gz',
        'pagecounts-20100831-200000.gz',
        'pagecounts-20100831-210000.gz',
        'pagecounts-20100831-220000.gz',
        'pagecounts-20100831-230000.gz',
    ]

    # md5 checksum hashes to python
    dt_md5 = 'md5sums.txt'
    dt_pd_md5 = pd.read_table(os.path.dirname(os.path.realpath(__file__)) + sl + dt_md5, delim_whitespace=True,
                              header=None, names=['md5', 'fname'], index_col=1)

    dt_pd_wiki_legacy = pd.DataFrame(columns=['project', 'page_title', 'counter', 'rsize', 'tstamp'])
    # dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])
    dt_pd_wiki_legacy.set_index('page_title', inplace=True, drop=True, append=False, verify_integrity=True)

    t = 0
    for x in files:
        if hashlib.md5(open(x, 'rb').read()).hexdigest() == dt_pd_md5.loc[x]['md5']:
            print('md5 match')
            f = gzip.open(x, 'rb')
            file_content = f.read()
            wframe = pd.read_table(gzip.open(x), sep=' ', usecols=[0, 1, 2, 3], names=['project', 'page_title', 'counter', 'rsize'], index_col=['page_title'])
            f.close()
            try:
                wframe = wframe.loc['Bitcoin']
                # wframe['tstamp'] = pd.to_datetime(dt.datetime.strptime(x[11:-3], "%Y%m%d-%H%M%S"))
                wframe['tstamp'] = x[11:-3]
                dt_pd_wiki_legacy = dt_pd_wiki_legacy.append(wframe)
                dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])
                print('----------------------------')
                print(t)
                print('progres: ', (t / len(files))*100,"%")
                dt_pd_wiki_legacy.to_pickle('dt_pd_wiki_legacy.pickle')
                t = t + 1
            except Exception:
                print('error in: ',x)
        else:
            sys.exit('md5 error')

    # dt_pd_wiki_legacy['tstamp'] = pd.to_datetime(dt_pd_wiki_legacy['tstamp'])

    print('current cycle of scraping done')

if __name__ == '__main__':
    main()
else:
    print("Run From Import")